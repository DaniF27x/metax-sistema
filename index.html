<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MetaX v5.0 - Sistema ULTRA COMPLETO</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            font-family: system-ui, -apple-system, sans-serif;
            background: #f8fafc;
        }
        #root { min-height: 100vh; }
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 1.5rem;
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="loading">üèÜ Auditoria da MetaX - Melhor Sistema de FiveM</div>
    </div>
    
    <script>
        console.log('üî• Iniciando MetaX System v4.0 - SISTEMA ULTRA COMPLETO...');
        
        // Aguardar carregamento completo do React
        setTimeout(() => {
            try {
                if (typeof React === 'undefined' || typeof ReactDOM === 'undefined') {
                    throw new Error('React n√£o carregado');
                }

                const { useState, useEffect, createElement: h } = React;
                
                // Hook personalizado para localStorage
                const useStoredState = (key, initialValue) => {
                    const [value, setValue] = useState(() => {
                        try {
                            const stored = localStorage.getItem('metax_' + key);
                            return stored ? JSON.parse(stored) : initialValue;
                        } catch {
                            return initialValue;
                        }
                    });

                    useEffect(() => {
                        try {
                            localStorage.setItem('metax_' + key, JSON.stringify(value));
                        } catch (e) {
                            console.warn('LocalStorage error:', e);
                        }
                    }, [key, value]);

                    return [value, setValue];
                };

                // Fun√ß√£o para calcular dura√ß√£o formatada
                const calcularDuracaoFormatada = (diferencaMs) => {
                    const segundos = Math.floor(diferencaMs / 1000);
                    const minutos = Math.floor(segundos / 60);
                    const horas = Math.floor(minutos / 60);
                    const dias = Math.floor(horas / 24);
                    
                    if (dias > 0) {
                        const horasRestantes = horas % 24;
                        const minutosRestantes = minutos % 60;
                        return `${dias}d ${horasRestantes}h ${minutosRestantes}m`;
                    } else if (horas > 0) {
                        const minutosRestantes = minutos % 60;
                        return `${horas}h ${minutosRestantes}m`;
                    } else {
                        return `${minutos}m`;
                    }
                };

                // Componente principal do sistema
                const MetaXSystem = () => {
                    const [currentUser, setCurrentUser] = useStoredState('currentUser', null);
                    const [users, setUsers] = useStoredState('users', []);
                    const [pendingUsers, setPendingUsers] = useStoredState('pendingUsers', []);
                    const [checklists, setChecklists] = useStoredState('checklists', []);
                    const [auditorias, setAuditorias] = useStoredState('auditorias', []);
                    const [currentView, setCurrentView] = useStoredState('currentView', 'login');

                    // Inicializar usu√°rios padr√£o
                    useEffect(() => {
                        const defaultUsers = [
                            {
                                id: 'admin001',
                                nome: 'Admin Sistema',
                                senha: 'admin123',
                                cargo: 'CEO',
                                status: 'aprovado',
                                createdAt: new Date().toISOString()
                            },
                            {
                                id: '7',
                                nome: 'Daniel',
                                senha: '5609984',
                                cargo: 'Diretor',
                                status: 'aprovado',
                                createdAt: new Date().toISOString()
                            }
                        ];

                        if (users.length === 0) {
                            setUsers(defaultUsers);
                        }
                    }, []);

                    // Componente de Login
                    const LoginPage = () => {
                        const [formData, setFormData] = useState({ id: '', senha: '' });
                        const [isRegister, setIsRegister] = useState(false);
                        const [isResetPassword, setIsResetPassword] = useState(false);
                        const [registerData, setRegisterData] = useState({
                            nome: '', id: '', senha: '', cargo: 'Staff Geral'
                        });
                        const [resetData, setResetData] = useState({ id: '', novaSenha: '' });

                        const handleLogin = (e) => {
                            e.preventDefault();
                            
                            const user = users.find(u => 
                                String(u.id) === String(formData.id) && 
                                String(u.senha) === String(formData.senha) && 
                                u.status === 'aprovado'
                            );
                            
                            if (user) {
                                setCurrentUser(user);
                                setCurrentView('dashboard');
                                console.log('‚úÖ Login realizado:', user.nome);
                            } else {
                                alert('‚ùå ID ou senha incorretos!');
                            }
                        };

                        const handleRegister = (e) => {
                            e.preventDefault();
                            
                            if (!registerData.nome || !registerData.id || !registerData.senha) {
                                alert('‚ö†Ô∏è Preencha todos os campos!');
                                return;
                            }

                            const userExists = [...users, ...pendingUsers].find(u => u.id === registerData.id);
                            if (userExists) {
                                alert('‚ùå ID j√° existe!');
                                return;
                            }

                            const newUser = {
                                ...registerData,
                                status: 'pendente',
                                createdAt: new Date().toISOString()
                            };

                            setPendingUsers([...pendingUsers, newUser]);
                            alert('‚úÖ Cadastro enviado para aprova√ß√£o!');
                            setIsRegister(false);
                            setRegisterData({ nome: '', id: '', senha: '', cargo: 'Staff Geral' });
                        };

                        const handlePasswordReset = (e) => {
                            e.preventDefault();
                            
                            if (!resetData.id || !resetData.novaSenha) {
                                alert('‚ö†Ô∏è Preencha todos os campos!');
                                return;
                            }

                            const userExists = users.find(u => u.id === resetData.id && u.status === 'aprovado');
                            if (!userExists) {
                                alert('‚ùå ID n√£o encontrado ou usu√°rio n√£o aprovado!');
                                return;
                            }

                            // Simula√ß√£o de reset de senha (atualizar diretamente)
                            setUsers(users.map(u => 
                                u.id === resetData.id ? { ...u, senha: resetData.novaSenha } : u
                            ));
                            
                            alert('‚úÖ Senha alterada com sucesso!');
                            setIsResetPassword(false);
                            setResetData({ id: '', novaSenha: '' });
                        };



                        const inputStyle = {
                            width: '100%',
                            padding: '12px',
                            border: '1px solid rgba(255,255,255,0.3)',
                            borderRadius: '8px',
                            background: 'rgba(255,255,255,0.1)',
                            color: 'white',
                            fontSize: '16px'
                        };

                        const buttonStyle = {
                            width: '100%',
                            padding: '12px',
                            borderRadius: '8px',
                            border: 'none',
                            fontSize: '16px',
                            fontWeight: 'bold',
                            cursor: 'pointer',
                            marginBottom: '8px'
                        };

                        return h('div', {
                            style: {
                                minHeight: '100vh',
                                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center',
                                padding: '20px'
                            }
                        },
                            h('div', {
                                style: {
                                    background: 'rgba(255,255,255,0.1)',
                                    backdropFilter: 'blur(10px)',
                                    borderRadius: '16px',
                                    padding: '40px',
                                    width: '100%',
                                    maxWidth: '400px',
                                    border: '1px solid rgba(255,255,255,0.2)'
                                }
                            },
                                // Header
                                h('div', { style: { textAlign: 'center', marginBottom: '30px' } },
                                    h('h1', { style: { color: 'white', fontSize: '2.5rem', marginBottom: '8px', fontWeight: 'bold' } }, 'MetaX'),
                                    h('p', { style: { color: '#e0e7ff', fontSize: '1.1rem' } }, 'Sistema de Auditoria - Ilusion RP')
                                ),

                                // Formul√°rios
                                !isRegister && !isResetPassword ? (
                                    // Login Form
                                    h('form', { onSubmit: handleLogin },
                                        h('div', { style: { marginBottom: '20px' } },
                                            h('label', { style: { display: 'block', color: 'rgba(255,255,255,0.9)', marginBottom: '8px', fontWeight: '500' } }, 'ID do Usu√°rio'),
                                            h('input', {
                                                type: 'text',
                                                value: formData.id,
                                                onChange: (e) => setFormData({ ...formData, id: e.target.value }),
                                                placeholder: 'Digite seu ID',
                                                style: inputStyle,
                                                required: true
                                            })
                                        ),
                                        h('div', { style: { marginBottom: '20px' } },
                                            h('label', { style: { display: 'block', color: 'rgba(255,255,255,0.9)', marginBottom: '8px', fontWeight: '500' } }, 'Senha'),
                                            h('input', {
                                                type: 'password',
                                                value: formData.senha,
                                                onChange: (e) => setFormData({ ...formData, senha: e.target.value }),
                                                placeholder: 'Digite sua senha',
                                                style: inputStyle,
                                                required: true
                                            })
                                        ),
                                        h('button', {
                                            type: 'submit',
                                            style: { ...buttonStyle, background: '#8b5cf6', color: 'white' }
                                        }, 'Entrar'),
                                        h('button', {
                                            type: 'button',
                                            onClick: () => setIsRegister(true),
                                            style: { ...buttonStyle, background: 'transparent', color: 'white', border: '1px solid rgba(255,255,255,0.3)' }
                                        }, 'Criar Conta'),
                                        h('button', {
                                            type: 'button',
                                            onClick: () => setIsResetPassword(true),
                                            style: { ...buttonStyle, background: 'transparent', color: 'white', border: '1px solid rgba(255,255,255,0.3)', marginTop: '8px' }
                                        }, 'üîê Esqueci minha Senha')
                                    )
                                ) : isRegister ? (
                                    // Register Form
                                    h('form', { onSubmit: handleRegister },
                                        h('div', { style: { marginBottom: '16px' } },
                                            h('label', { style: { display: 'block', color: 'rgba(255,255,255,0.9)', marginBottom: '6px', fontWeight: '500' } }, 'Nome Completo'),
                                            h('input', {
                                                type: 'text',
                                                value: registerData.nome,
                                                onChange: (e) => setRegisterData({ ...registerData, nome: e.target.value }),
                                                placeholder: 'Seu nome completo',
                                                style: inputStyle,
                                                required: true
                                            })
                                        ),
                                        h('div', { style: { marginBottom: '16px' } },
                                            h('label', { style: { display: 'block', color: 'rgba(255,255,255,0.9)', marginBottom: '6px', fontWeight: '500' } }, 'ID'),
                                            h('input', {
                                                type: 'text',
                                                value: registerData.id,
                                                onChange: (e) => setRegisterData({ ...registerData, id: e.target.value }),
                                                placeholder: 'Escolha um ID √∫nico',
                                                style: inputStyle,
                                                required: true
                                            })
                                        ),
                                        h('div', { style: { marginBottom: '16px' } },
                                            h('label', { style: { display: 'block', color: 'rgba(255,255,255,0.9)', marginBottom: '6px', fontWeight: '500' } }, 'Senha'),
                                            h('input', {
                                                type: 'password',
                                                value: registerData.senha,
                                                onChange: (e) => setRegisterData({ ...registerData, senha: e.target.value }),
                                                placeholder: 'Crie uma senha',
                                                style: inputStyle,
                                                required: true
                                            })
                                        ),
                                        h('div', { style: { marginBottom: '20px' } },
                                            h('label', { style: { display: 'block', color: 'rgba(255,255,255,0.9)', marginBottom: '6px', fontWeight: '500' } }, 'Cargo'),
                                            h('select', {
                                                value: registerData.cargo,
                                                onChange: (e) => setRegisterData({ ...registerData, cargo: e.target.value }),
                                                style: { ...inputStyle, color: 'black' },
                                                required: true
                                            },
                                                ['CEO', 'Diretor', 'Alta C√∫pula', 'ADM Staff', 'RESP Comunidade', 'Mentoria', 'Staff Geral'].map(cargo =>
                                                    h('option', { key: cargo, value: cargo }, cargo)
                                                )
                                            )
                                        ),
                                        h('button', {
                                            type: 'submit',
                                            style: { ...buttonStyle, background: '#10b981', color: 'white' }
                                        }, 'Cadastrar'),
                                        h('button', {
                                            type: 'button',
                                            onClick: () => setIsRegister(false),
                                            style: { ...buttonStyle, background: 'transparent', color: 'white', border: '1px solid rgba(255,255,255,0.3)' }
                                        }, 'Voltar ao Login')
                                    )
                                ) : (
                                    // Reset Password Form
                                    h('form', { onSubmit: handlePasswordReset },
                                        h('div', { style: { marginBottom: '16px' } },
                                            h('label', { style: { display: 'block', color: 'rgba(255,255,255,0.9)', marginBottom: '6px', fontWeight: '500' } }, 'ID do Usu√°rio'),
                                            h('input', {
                                                type: 'text',
                                                value: resetData.id,
                                                onChange: (e) => setResetData({ ...resetData, id: e.target.value }),
                                                placeholder: 'Digite seu ID',
                                                style: inputStyle,
                                                required: true
                                            })
                                        ),
                                        h('div', { style: { marginBottom: '20px' } },
                                            h('label', { style: { display: 'block', color: 'rgba(255,255,255,0.9)', marginBottom: '6px', fontWeight: '500' } }, 'Nova Senha'),
                                            h('input', {
                                                type: 'password',
                                                value: resetData.novaSenha,
                                                onChange: (e) => setResetData({ ...resetData, novaSenha: e.target.value }),
                                                placeholder: 'Digite a nova senha',
                                                style: inputStyle,
                                                required: true
                                            })
                                        ),
                                        h('button', {
                                            type: 'submit',
                                            style: { ...buttonStyle, background: '#f59e0b', color: 'white' }
                                        }, 'üîê Solicitar Reset'),
                                        h('button', {
                                            type: 'button',
                                            onClick: () => setIsResetPassword(false),
                                            style: { ...buttonStyle, background: 'transparent', color: 'white', border: '1px solid rgba(255,255,255,0.3)' }
                                        }, 'Voltar ao Login')
                                    )
                                )
                            )
                        );
                    };

                    // Header do sistema
                    const Header = () => h('header', {
                        style: {
                            background: 'white',
                            borderBottom: '4px solid #8b5cf6',
                            boxShadow: '0 2px 4px rgba(0,0,0,0.1)'
                        }
                    },
                        h('div', {
                            style: {
                                maxWidth: '1200px',
                                margin: '0 auto',
                                padding: '16px 20px',
                                display: 'flex',
                                justifyContent: 'space-between',
                                alignItems: 'center'
                            }
                        },
                            h('div', null,
                                h('h1', { style: { fontSize: '1.8rem', fontWeight: 'bold', color: '#1f2937', margin: 0 } }, 'MetaX - Ilusion RP'),
                                h('p', { style: { fontSize: '0.9rem', color: '#6b7280', margin: '4px 0 0 0' } }, 'Sistema de Auditoria ULTRA COMPLETO')
                            ),
                            h('div', { style: { display: 'flex', alignItems: 'center', gap: '16px' } },
                                h('div', { style: { textAlign: 'right' } },
                                    h('p', { style: { fontWeight: '600', color: '#1f2937', margin: 0, fontSize: '1rem' } }, currentUser?.nome || 'Usu√°rio'),
                                    h('p', { style: { fontSize: '0.8rem', color: '#6b7280', margin: 0 } }, `${currentUser?.cargo} | ID: ${currentUser?.id}`)
                                ),
                                h('button', {
                                    onClick: () => {
                                        setCurrentUser(null);
                                        setCurrentView('login');
                                    },
                                    style: {
                                        background: '#ef4444',
                                        color: 'white',
                                        padding: '8px 16px',
                                        border: 'none',
                                        borderRadius: '6px',
                                        cursor: 'pointer',
                                        fontWeight: '500'
                                    }
                                }, 'Sair')
                            )
                        )
                    );

                    // Navega√ß√£o lateral
                    const Sidebar = () => h('nav', {
                        style: {
                            background: '#1f2937',
                            color: 'white',
                            width: '250px',
                            minHeight: 'calc(100vh - 80px)',
                            padding: '20px 0'
                        }
                    },
                        h('div', { style: { padding: '0 20px' } },
                            [
                                { id: 'dashboard', label: 'üìä Dashboard', icon: 'üìä' },
                                { id: 'checklist', label: '‚úÖ Checklist', icon: '‚úÖ' },
                                { id: 'auditoria', label: 'üîç Auditoria', icon: 'üîç' },
                                { id: 'painel', label: 'üèôÔ∏è Painel da Cidade', icon: 'üèôÔ∏è' },
                                ...(currentUser?.cargo === 'CEO' || currentUser?.cargo === 'Diretor' 
                                    ? [{ id: 'admin', label: '‚öôÔ∏è Administra√ß√£o', icon: '‚öôÔ∏è' }] 
                                    : [])
                            ].map(item =>
                                h('button', {
                                    key: item.id,
                                    onClick: () => setCurrentView(item.id),
                                    style: {
                                        width: '100%',
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '12px',
                                        padding: '12px 16px',
                                        background: currentView === item.id ? '#8b5cf6' : 'transparent',
                                        color: 'white',
                                        border: 'none',
                                        borderRadius: '8px',
                                        cursor: 'pointer',
                                        marginBottom: '8px',
                                        fontSize: '1rem',
                                        textAlign: 'left'
                                    }
                                }, item.label)
                            )
                        )
                    );

                    // Dashboard
                    const DashboardPage = () => {
                        // Calcular m√©tricas avan√ßadas
                        const meusChecklists = checklists.filter(c => c.autorId === currentUser?.id);
                        const minhasAuditorias = auditorias.filter(a => a.autorId === currentUser?.id);
                        const meusPendentes = [...checklists, ...auditorias].filter(item => 
                            item.status === 'aguardando_aprovacao' && item.autorId === currentUser?.id
                        );
                        
                        const meusAprovados = [...checklists, ...auditorias].filter(item => 
                            (item.status === 'aprovado' || item.status === 'aprovada') && item.autorId === currentUser?.id
                        );
                        
                        const totalItens = meusChecklists.length + minhasAuditorias.length;
                        const taxaAprovacao = totalItens > 0 ? Math.round((meusAprovados.length / totalItens) * 100) : 0;
                        
                        // Atividade das √∫ltimas 24h
                        const agora = new Date();
                        const ha24h = new Date(agora.getTime() - 24 * 60 * 60 * 1000);
                        const atividadeRecente = [...checklists, ...auditorias].filter(item => 
                            item.autorId === currentUser?.id && new Date(item.createdAt) > ha24h
                        );
                        
                        // Pr√≥ximas a√ß√µes necess√°rias
                        const itensEmAndamento = [...checklists, ...auditorias].filter(item => 
                            item.autorId === currentUser?.id && (item.status === 'em_andamento' || item.status === 'rascunho')
                        );
                        
                        return h('div', { style: { minHeight: '100vh', background: '#f8fafc' } },
                            h(Header),
                            h('div', { style: { display: 'flex' } },
                                h(Sidebar),
                                h('main', { style: { flex: 1, padding: '40px' } },
                                    h('h2', { style: { fontSize: '2.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '32px' } }, 
                                        `üéØ Dashboard - ${currentUser?.nome}`
                                    ),
                                    
                                    // Cards de estat√≠sticas principais
                                    h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '24px', marginBottom: '32px' } },
                                        h('div', { style: { background: 'linear-gradient(135deg, #3b82f6, #1d4ed8)', color: 'white', padding: '28px', borderRadius: '16px', position: 'relative', overflow: 'hidden' } },
                                            h('div', { style: { position: 'absolute', top: '-20px', right: '-20px', fontSize: '8rem', opacity: 0.1 } }, '‚úÖ'),
                                            h('div', { style: { fontSize: '3.5rem', marginBottom: '12px' } }, '‚úÖ'),
                                            h('h3', { style: { fontSize: '1.3rem', marginBottom: '8px', opacity: 0.95, fontWeight: '600' } }, 'Meus Checklists'),
                                            h('p', { style: { fontSize: '3rem', fontWeight: 'bold', margin: '0 0 8px 0' } }, meusChecklists.length),
                                            h('div', { style: { display: 'flex', alignItems: 'center', gap: '8px', opacity: 0.9 } },
                                                h('span', { style: { fontSize: '0.9rem' } }, 
                                                    `${meusChecklists.filter(c => c.status === 'aprovado').length} aprovados ‚Ä¢ ${meusChecklists.filter(c => c.status === 'aguardando_aprovacao').length} pendentes`
                                                )
                                            )
                                        ),
                                        h('div', { style: { background: 'linear-gradient(135deg, #10b981, #059669)', color: 'white', padding: '28px', borderRadius: '16px', position: 'relative', overflow: 'hidden' } },
                                            h('div', { style: { position: 'absolute', top: '-20px', right: '-20px', fontSize: '8rem', opacity: 0.1 } }, 'üîç'),
                                            h('div', { style: { fontSize: '3.5rem', marginBottom: '12px' } }, 'üîç'),
                                            h('h3', { style: { fontSize: '1.3rem', marginBottom: '8px', opacity: 0.95, fontWeight: '600' } }, 'Minhas Auditorias'),
                                            h('p', { style: { fontSize: '3rem', fontWeight: 'bold', margin: '0 0 8px 0' } }, minhasAuditorias.length),
                                            h('div', { style: { display: 'flex', alignItems: 'center', gap: '8px', opacity: 0.9 } },
                                                h('span', { style: { fontSize: '0.9rem' } }, 
                                                    `${minhasAuditorias.filter(a => a.status === 'aprovada').length} aprovadas ‚Ä¢ ${minhasAuditorias.filter(a => a.status === 'aguardando_aprovacao').length} pendentes`
                                                )
                                            )
                                        ),
                                        h('div', { style: { background: 'linear-gradient(135deg, #f59e0b, #d97706)', color: 'white', padding: '28px', borderRadius: '16px', position: 'relative', overflow: 'hidden' } },
                                            h('div', { style: { position: 'absolute', top: '-20px', right: '-20px', fontSize: '8rem', opacity: 0.1 } }, '‚è≥'),
                                            h('div', { style: { fontSize: '3.5rem', marginBottom: '12px' } }, '‚è≥'),
                                            h('h3', { style: { fontSize: '1.3rem', marginBottom: '8px', opacity: 0.95, fontWeight: '600' } }, 'Aguardando Aprova√ß√£o'),
                                            h('p', { style: { fontSize: '3rem', fontWeight: 'bold', margin: '0 0 8px 0' } }, meusPendentes.length),
                                            h('div', { style: { display: 'flex', alignItems: 'center', gap: '8px', opacity: 0.9 } },
                                                h('span', { style: { fontSize: '0.9rem' } }, 
                                                    meusPendentes.length > 0 ? 'Aguarde a revis√£o' : 'Tudo aprovado! üéâ'
                                                )
                                            )
                                        ),
                                        h('div', { style: { background: 'linear-gradient(135deg, #8b5cf6, #7c3aed)', color: 'white', padding: '28px', borderRadius: '16px', position: 'relative', overflow: 'hidden' } },
                                            h('div', { style: { position: 'absolute', top: '-20px', right: '-20px', fontSize: '8rem', opacity: 0.1 } }, 'üìä'),
                                            h('div', { style: { fontSize: '3.5rem', marginBottom: '12px' } }, 'üìä'),
                                            h('h3', { style: { fontSize: '1.3rem', marginBottom: '8px', opacity: 0.95, fontWeight: '600' } }, 'Taxa de Aprova√ß√£o'),
                                            h('p', { style: { fontSize: '3rem', fontWeight: 'bold', margin: '0 0 8px 0' } }, `${taxaAprovacao}%`),
                                            h('div', { style: { display: 'flex', alignItems: 'center', gap: '8px', opacity: 0.9 } },
                                                h('span', { style: { fontSize: '0.9rem' } }, 
                                                    `${meusAprovados.length} de ${totalItens} aprovados`
                                                )
                                            )
                                        )
                                    ),

                                    // M√©tricas secund√°rias
                                    h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(220px, 1fr))', gap: '20px', marginBottom: '32px' } },
                                        h('div', { style: { background: 'white', padding: '20px', borderRadius: '12px', boxShadow: '0 2px 4px rgba(0, 0, 0, 0.1)', border: '1px solid #e5e7eb' } },
                                            h('div', { style: { display: 'flex', alignItems: 'center', marginBottom: '12px' } },
                                                h('div', { style: { fontSize: '2rem', marginRight: '12px' } }, '‚ö°'),
                                                h('h4', { style: { fontSize: '1.1rem', fontWeight: '700', color: '#1f2937', margin: 0 } }, '√öltimas 24h')
                                            ),
                                            h('p', { style: { fontSize: '2rem', fontWeight: 'bold', color: '#059669', margin: '0 0 4px 0' } }, atividadeRecente.length),
                                            h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, 'itens criados')
                                        ),
                                        h('div', { style: { background: 'white', padding: '20px', borderRadius: '12px', boxShadow: '0 2px 4px rgba(0, 0, 0, 0.1)', border: '1px solid #e5e7eb' } },
                                            h('div', { style: { display: 'flex', alignItems: 'center', marginBottom: '12px' } },
                                                h('div', { style: { fontSize: '2rem', marginRight: '12px' } }, 'üìù'),
                                                h('h4', { style: { fontSize: '1.1rem', fontWeight: '700', color: '#1f2937', margin: 0 } }, 'Em Andamento')
                                            ),
                                            h('p', { style: { fontSize: '2rem', fontWeight: 'bold', color: '#d97706', margin: '0 0 4px 0' } }, itensEmAndamento.length),
                                            h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, 'para finalizar')
                                        ),
                                        h('div', { style: { background: 'white', padding: '20px', borderRadius: '12px', boxShadow: '0 2px 4px rgba(0, 0, 0, 0.1)', border: '1px solid #e5e7eb' } },
                                            h('div', { style: { display: 'flex', alignItems: 'center', marginBottom: '12px' } },
                                                h('div', { style: { fontSize: '2rem', marginRight: '12px' } }, 'üë§'),
                                                h('h4', { style: { fontSize: '1.1rem', fontWeight: '700', color: '#1f2937', margin: 0 } }, 'Seu Cargo')
                                            ),
                                            h('p', { style: { fontSize: '1.2rem', fontWeight: 'bold', color: '#8b5cf6', margin: '0 0 4px 0' } }, currentUser?.cargo),
                                            h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, `ID: ${currentUser?.id}`)
                                        ),
                                        h('div', { style: { background: 'white', padding: '20px', borderRadius: '12px', boxShadow: '0 2px 4px rgba(0, 0, 0, 0.1)', border: '1px solid #e5e7eb' } },
                                            h('div', { style: { display: 'flex', alignItems: 'center', marginBottom: '12px' } },
                                                h('div', { style: { fontSize: '2rem', marginRight: '12px' } }, 'üèÜ'),
                                                h('h4', { style: { fontSize: '1.1rem', fontWeight: '700', color: '#1f2937', margin: 0 } }, 'Pontua√ß√£o')
                                            ),
                                            h('p', { style: { fontSize: '2rem', fontWeight: 'bold', color: '#dc2626', margin: '0 0 4px 0' } }, 
                                                (meusChecklists.filter(c => c.status === 'aprovado').length * 50) + 
                                                (minhasAuditorias.filter(a => a.status === 'aprovada').length * 100)
                                            ),
                                            h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, 'pontos gerados')
                                        )
                                    ),

                                    // Alertas e a√ß√µes r√°pidas
                                    itensEmAndamento.length > 0 && h('div', { style: { background: '#fef3c7', border: '2px solid #f59e0b', borderRadius: '16px', padding: '24px', marginBottom: '32px' } },
                                        h('div', { style: { display: 'flex', alignItems: 'center', marginBottom: '16px' } },
                                            h('div', { style: { fontSize: '2.5rem', marginRight: '16px' } }, '‚ö†Ô∏è'),
                                            h('h3', { style: { fontSize: '1.5rem', fontWeight: 'bold', color: '#92400e', margin: 0 } }, 'A√ß√µes Necess√°rias')
                                        ),
                                        h('div', { style: { display: 'grid', gap: '12px' } },
                                            itensEmAndamento.slice(0, 3).map(item => 
                                                h('div', { key: item.id, style: { display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '12px', background: 'white', borderRadius: '8px', border: '1px solid #f59e0b' } },
                                                    h('div', null,
                                                        h('p', { style: { fontWeight: '600', color: '#1f2937', margin: '0 0 4px 0' } }, 
                                                            `${item.tipo || 'Auditoria'} - ${item.equipe || item.setor || 'N√£o especificado'}`
                                                        ),
                                                        h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, 
                                                            `Criado em ${new Date(item.createdAt).toLocaleDateString('pt-BR')}`
                                                        )
                                                    ),
                                                    h('button', {
                                                        onClick: () => setCurrentView(item.tipo ? 'checklist' : 'auditoria'),
                                                        style: {
                                                            background: '#f59e0b',
                                                            color: 'white',
                                                            padding: '8px 16px',
                                                            border: 'none',
                                                            borderRadius: '6px',
                                                            cursor: 'pointer',
                                                            fontWeight: '600',
                                                            fontSize: '0.85rem'
                                                        }
                                                    }, 'üìù Finalizar')
                                                )
                                            )
                                        ),
                                        itensEmAndamento.length > 3 && h('p', { style: { textAlign: 'center', marginTop: '12px', color: '#92400e', fontWeight: '600' } }, 
                                            `... e mais ${itensEmAndamento.length - 3} itens pendentes`
                                        )
                                    ),

                                    // Bem-vindo melhorado
                                    h('div', { style: { background: 'white', borderRadius: '20px', padding: '40px', boxShadow: '0 8px 32px rgba(0, 0, 0, 0.1)', textAlign: 'center', position: 'relative', overflow: 'hidden' } },
                                        h('div', { style: { position: 'absolute', top: '-50px', right: '-50px', fontSize: '15rem', opacity: 0.03, transform: 'rotate(15deg)' } }, 'üéâ'),
                                        h('h3', { style: { fontSize: '2.4rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '20px' } }, 'üöÄ MetaX v5.0 ULTRA COMPLETO!'),
                                        h('p', { style: { color: '#16a34a', fontSize: '1.4rem', lineHeight: 1.6, marginBottom: '32px', fontWeight: '500' } }, 
                                            '‚úÖ Sistema 100% funcional com painel admin melhorado, m√©tricas avan√ßadas e alertas inteligentes!'
                                        ),
                                        h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(240px, 1fr))', gap: '20px', marginTop: '32px' } },
                                            h('div', { style: { background: 'linear-gradient(135deg, #f0fdf4, #dcfce7)', padding: '24px', borderRadius: '16px', border: '2px solid #16a34a' } },
                                                h('div', { style: { fontSize: '3rem', marginBottom: '12px' } }, 'üöî'),
                                                h('p', { style: { fontWeight: 'bold', color: '#16a34a', margin: 0, fontSize: '1.1rem' } }, 'Pol√≠cia com Subsetores'),
                                                h('p', { style: { fontSize: '0.9rem', color: '#15803d', margin: '8px 0 0 0', opacity: 0.8 } }, 'PRF, Civil, Militar, BOPE...')
                                            ),
                                            h('div', { style: { background: 'linear-gradient(135deg, #fefbff, #faf5ff)', padding: '24px', borderRadius: '16px', border: '2px solid #8b5cf6' } },
                                                h('div', { style: { fontSize: '3rem', marginBottom: '12px' } }, 'üìä'),
                                                h('p', { style: { fontWeight: 'bold', color: '#8b5cf6', margin: 0, fontSize: '1.1rem' } }, 'Dashboard Inteligente'),
                                                h('p', { style: { fontSize: '0.9rem', color: '#7c3aed', margin: '8px 0 0 0', opacity: 0.8 } }, 'M√©tricas avan√ßadas e alertas')
                                            ),
                                            h('div', { style: { background: 'linear-gradient(135deg, #fefbff, #fef3c7)', padding: '24px', borderRadius: '16px', border: '2px solid #f59e0b' } },
                                                h('div', { style: { fontSize: '3rem', marginBottom: '12px' } }, '‚ö°'),
                                                h('p', { style: { fontWeight: 'bold', color: '#d97706', margin: 0, fontSize: '1.1rem' } }, 'Admin Melhorado'),
                                                h('p', { style: { fontSize: '0.9rem', color: '#b45309', margin: '8px 0 0 0', opacity: 0.8 } }, 'Interface clara quando vazia')
                                            ),
                                            h('div', { style: { background: 'linear-gradient(135deg, #f0f9ff, #e0f2fe)', padding: '24px', borderRadius: '16px', border: '2px solid #0ea5e9' } },
                                                h('div', { style: { fontSize: '3rem', marginBottom: '12px' } }, 'üéØ'),
                                                h('p', { style: { fontWeight: 'bold', color: '#0ea5e9', margin: 0, fontSize: '1.1rem' } }, 'Meta: 815 Pontos'),
                                                h('p', { style: { fontSize: '0.9rem', color: '#0284c7', margin: '8px 0 0 0', opacity: 0.8 } }, 'Sistema de pontua√ß√£o ativo')
                                            )
                                        )
                                    )
                                )
                            )
                        );
                    };

                    // P√°gina de Checklist - SISTEMA FUNCIONAL CORRIGIDO
                    const ChecklistPage = () => {
                        const [currentChecklistState, setCurrentChecklistState] = useState(null);
                        const [checklistFormState, setChecklistFormState] = useState({});

                        const startNewChecklist = (tipo) => {
                            const newChecklist = {
                                id: Date.now(),
                                tipo,
                                autorId: currentUser.id,
                                status: 'em_andamento',
                                createdAt: new Date().toISOString(),
                                confirmacoesPainel: { manha: '', tarde: '', noite: '' }
                            };
                            setCurrentChecklistState(newChecklist);
                            setChecklistFormState({});
                        };

                        const saveChecklistData = () => {
                            if (!checklistFormState.equipe && !checklistFormState.setor) {
                                alert('‚ö†Ô∏è Selecione uma equipe ou setor!');
                                return;
                            }

                            const updatedChecklist = {
                                ...currentChecklistState,
                                ...checklistFormState,
                                updatedAt: new Date().toISOString()
                            };

                            // Verificar confirma√ß√µes de painel
                            const confirmacoesCompletas = Object.values(updatedChecklist.confirmacoesPainel).every(val => val !== '' && val !== null);
                            
                            if (confirmacoesCompletas) {
                                updatedChecklist.status = 'aguardando_aprovacao';
                                alert('‚úÖ Checklist enviado para aprova√ß√£o!');
                            } else {
                                alert('üíæ Checklist salvo como rascunho! Complete as confirma√ß√µes para envio.');
                            }

                            const existingIndex = checklists.findIndex(c => c.id === currentChecklistState.id);
                            if (existingIndex >= 0) {
                                setChecklists(checklists.map(c => c.id === currentChecklistState.id ? updatedChecklist : c));
                            } else {
                                setChecklists([...checklists, updatedChecklist]);
                            }

                            setCurrentChecklistState(null);
                            setChecklistFormState({});
                        };



                        // Se est√° editando um checklist espec√≠fico, mostrar formul√°rio
                        if (currentChecklistState) {
                        return h('div', { style: { minHeight: '100vh', background: '#f8fafc' } },
                                h(Header),
                                h('div', { style: { display: 'flex' } },
                                    h(Sidebar),
                                    h('main', { style: { flex: 1, padding: '40px', maxWidth: '1400px', margin: '0 auto' } },
                                        h('div', { style: { background: 'white', borderRadius: '16px', padding: '32px', boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)' } },
                                            h('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' } },
                                                h('h2', { style: { fontSize: '2.4rem', fontWeight: 'bold', color: '#1f2937', margin: 0 } }, 
                                                    currentChecklistState.tipo === 'staff' ? '‚úÖ CHECKLIST STAFF' : 'üé≠ CHECKLIST ROLEPLAY'
                                                ),
                                                h('button', {
                                                    onClick: () => setCurrentChecklistState(null),
                                                    style: {
                                                        background: '#6b7280',
                                                        color: 'white',
                                                        padding: '12px 24px',
                                                        border: 'none',
                                                        borderRadius: '8px',
                                                        cursor: 'pointer',
                                                        fontWeight: '600'
                                                    }
                                                }, '‚ùå Cancelar')
                                            ),
                                            
                                            h('div', { style: { display: 'grid', gap: '32px' } },
                                                // Se√ß√£o b√°sica
                                                h('div', { style: { background: 'linear-gradient(135deg, #3b82f6, #1e40af)', padding: '32px', borderRadius: '16px', color: 'white' } },
                                                    h('h3', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '24px' } }, 'üìã DADOS B√ÅSICOS'),
                                                    h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '24px' } },
                                                        h('div', null,
                                                            h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '8px' } }, 
                                                                currentChecklistState.tipo === 'staff' ? 'üè¢ Equipe Staff' : 'üèõÔ∏è Setor RP'
                                                            ),
                                                            h('select', {
                                                                value: checklistFormState[currentChecklistState.tipo === 'staff' ? 'equipe' : 'setor'] || '',
                                                                onChange: (e) => setChecklistFormState({
                                                                    ...checklistFormState,
                                                                    [currentChecklistState.tipo === 'staff' ? 'equipe' : 'setor']: e.target.value
                                                                }),
                                                                style: {
                                                                    width: '100%',
                                                                    padding: '14px',
                                                                    border: '2px solid white',
                                                                    borderRadius: '8px',
                                                                    fontSize: '1rem',
                                                                    background: 'white',
                                                                    color: '#1f2937',
                                                                    fontWeight: '500'
                                                                }
                                                            },
                                                                h('option', { value: '' }, 'Selecione...'),
                                                                (currentChecklistState.tipo === 'staff' 
                                                                    ? ['Alta C√∫pula', 'ADM Staff', 'RESP Comunidade', 'Mentoria', 'Equipe Legal', 'Social Media', 'Comercial', 'Ticketing', 'Eventos']
                                                                    : ['Jur√≠dico', 'Prefeitura', 'Igreja', 'Jornal', 'Hospital', 'Bombeiros', 'Mec√¢nica', 'Empres√°rios', 'Fac√ß√£o', 'M√°fia', 'Pol√≠cia']
                                                                ).map(item => h('option', { key: item, value: item }, item))
                                                            )
                                                        ),
                                                        // Subsetor para pol√≠cia no checklist
                                                        checklistFormState.setor === 'Pol√≠cia' && h('div', null,
                                                            h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '8px' } }, 'üöî Subsetor da Pol√≠cia'),
                                                            h('select', {
                                                                value: checklistFormState.subsetor || '',
                                                                onChange: (e) => setChecklistFormState({...checklistFormState, subsetor: e.target.value}),
                                                                style: {
                                                                    width: '100%',
                                                                    padding: '14px',
                                                                    border: '2px solid white',
                                                                    borderRadius: '8px',
                                                                    fontSize: '1rem',
                                                                    background: 'white',
                                                                    color: '#1f2937',
                                                                    fontWeight: '500'
                                                                }
                                                            },
                                                                h('option', { value: '' }, 'Selecione o subsetor...'),
                                                                ['PRF', 'Federal', 'Civil', 'Militar', 'Pris√£o', 'BOPE', 'MPF', 'Seguran√ßa Jur√≠dica'].map(sub => 
                                                                    h('option', { key: sub, value: sub }, sub)
                                                                )
                                                            )
                                                        )
                                                    )
                                                ),
                                                
                                                // Se√ß√£o adicional para Staff com perguntas espec√≠ficas - CORRIGIDA
                                                currentChecklistState.tipo === 'staff' && h('div', { style: { marginTop: '40px', padding: '32px', background: 'linear-gradient(135deg, #8b5cf6, #7c3aed)', borderRadius: '20px' } },
                                                    h('h4', { style: { fontSize: '1.6rem', fontWeight: 'bold', color: 'white', marginBottom: '24px' } }, 'üë• AN√ÅLISE DETALHADA DA EQUIPE STAFF'),
                                                    h('div', { style: { display: 'grid', gap: '28px' } },
                                                        [
                                                            { q: 'üè¢ A estrutura organizacional da equipe est√° bem definida?', key: 'estruturaOrganizacional' },
                                                            { q: '‚ö° Os membros respondem rapidamente aos chamados/tickets?', key: 'rapidezResposta' },
                                                            { q: 'üìã Existe cumprimento das normas internas estabelecidas?', key: 'cumprimentoNormas' },
                                                            { q: 'üéØ As metas da equipe est√£o sendo atingidas regularmente?', key: 'metasAtingidas' },
                                                            { q: 'ü§ù H√° boa comunica√ß√£o e colabora√ß√£o entre os membros?', key: 'colaboracaoEquipe' },
                                                            { q: 'üîÑ A equipe se adapta bem √†s mudan√ßas e atualiza√ß√µes?', key: 'adaptacaoMudancas' },
                                                            { q: 'üìä Os relat√≥rios e documenta√ß√µes est√£o em dia?', key: 'relatoriosEmDia' },
                                                            { q: 'üéì H√° necessidade de treinamento ou capacita√ß√£o?', key: 'necessidadeTreinamento' }
                                                        ].map((item, index) =>
                                                            h('div', { key: `staff_${index}`, style: { padding: '24px', background: 'rgba(255, 255, 255, 0.15)', borderRadius: '16px' } },
                                                                h('label', { style: { display: 'block', color: 'white', fontWeight: '700', marginBottom: '18px', fontSize: '1.2rem' } }, 
                                                                    `${index + 1}. ${item.q}`
                                                                ),
                                                                h('div', { style: { display: 'flex', gap: '18px', flexWrap: 'wrap', marginBottom: '18px' } },
                                                                    ['excelente', 'bom', 'regular', 'ruim', 'nao_verificado'].map(opcao => {
                                                                        const labels = { 
                                                                            excelente: 'üèÜ Excelente', 
                                                                            bom: '‚úÖ Bom', 
                                                                            regular: '‚ö†Ô∏è Regular', 
                                                                            ruim: '‚ùå Ruim',
                                                                            nao_verificado: '‚ùì N√£o Verificado'
                                                                        };
                                                                        return h('label', { 
                                                                            key: opcao,
                                                                            style: { 
                                                                                display: 'flex', 
                                                                                alignItems: 'center',
                                                                                gap: '12px',
                                                                                cursor: 'pointer',
                                                                                fontSize: '1rem',
                                                                                padding: '14px 20px',
                                                                                borderRadius: '12px',
                                                                                background: checklistFormState[`staff_${item.key}`] === opcao ? 'rgba(255, 255, 255, 0.35)' : 'rgba(255, 255, 255, 0.15)',
                                                                                border: '3px solid ' + (checklistFormState[`staff_${item.key}`] === opcao ? 'white' : 'rgba(255, 255, 255, 0.4)'),
                                                                                fontWeight: '600'
                                                                            }
                                                                        },
                                                                            h('input', {
                                                                                type: 'radio',
                                                                                name: `staff_${item.key}`,
                                                                                value: opcao,
                                                                                checked: checklistFormState[`staff_${item.key}`] === opcao,
                                                                                onChange: (e) => setChecklistFormState({...checklistFormState, [`staff_${item.key}`]: e.target.value}),
                                                                                style: { margin: 0, transform: 'scale(1.4)' }
                                                                            }),
                                                                            h('span', { style: { color: 'white', fontWeight: '700' } }, labels[opcao])
                                                                        );
                                                                    })
                                                                ),
                                                                h('textarea', {
                                                                    value: checklistFormState[`obs_staff_${item.key}`] || '',
                                                                    onChange: (e) => setChecklistFormState({...checklistFormState, [`obs_staff_${item.key}`]: e.target.value}),
                                                                    style: {
                                                                        width: '100%',
                                                                        padding: '16px',
                                                                        border: '3px solid rgba(255, 255, 255, 0.4)',
                                                                        borderRadius: '12px',
                                                                        fontSize: '1rem',
                                                                        background: 'rgba(255, 255, 255, 0.2)',
                                                                        color: 'white',
                                                                        fontFamily: 'inherit',
                                                                        resize: 'vertical',
                                                                        minHeight: '100px'
                                                                    },
                                                                    placeholder: `Observa√ß√µes detalhadas sobre: ${item.q}...`
                                                                })
                                                            )
                                                        )
                                                    )
                                                ),

                                                // Se√ß√£o de perguntas espec√≠ficas por tipo
                                                currentChecklistState.tipo === 'staff' ? (
                                                    // Staff Checklist - Perguntas espec√≠ficas COMPLETAS
                                                    h('div', { style: { background: 'linear-gradient(135deg, #10b981, #059669)', padding: '32px', borderRadius: '16px', color: 'white' } },
                                                        h('h3', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '24px' } }, 'üìä AN√ÅLISE COMPLETA DA EQUIPE STAFF'),
                                                        h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '24px' } },
                                                            h('div', null,
                                                                h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '8px' } }, 'üë• Total de Pessoas na Equipe'),
                                                                h('input', {
                                                                    type: 'number',
                                                                    min: '0',
                                                                    value: checklistFormState.totalPessoas || '',
                                                                    onChange: (e) => setChecklistFormState({...checklistFormState, totalPessoas: e.target.value}),
                                                                    style: {
                                                                        width: '100%',
                                                                        padding: '16px',
                                                                        border: '3px solid white',
                                                                        borderRadius: '10px',
                                                                        fontSize: '1.1rem',
                                                                        background: 'white',
                                                                        color: '#1f2937',
                                                                        fontWeight: '600',
                                                                        textAlign: 'center'
                                                                    }
                                                                })
                                                            ),
                                                            h('div', null,
                                                                h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '8px' } }, '‚úÖ Pessoas Ativas'),
                                                                h('input', {
                                                                    type: 'number',
                                                                    min: '0',
                                                                    value: checklistFormState.pessoasAtivas || '',
                                                                    onChange: (e) => setChecklistFormState({...checklistFormState, pessoasAtivas: e.target.value}),
                                                                    style: {
                                                                        width: '100%',
                                                                        padding: '16px',
                                                                        border: '3px solid white',
                                                                        borderRadius: '10px',
                                                                        fontSize: '1.1rem',
                                                                        background: 'white',
                                                                        color: '#1f2937',
                                                                        fontWeight: '600',
                                                                        textAlign: 'center'
                                                                    }
                                                                })
                                                            ),
                                                            h('div', null,
                                                                h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '8px' } }, 'üí¨ Pessoas no Discord'),
                                                                h('input', {
                                                                    type: 'number',
                                                                    min: '0',
                                                                    value: checklistFormState.pessoasDiscord || '',
                                                                    onChange: (e) => setChecklistFormState({...checklistFormState, pessoasDiscord: e.target.value}),
                                                                    style: {
                                                                        width: '100%',
                                                                        padding: '16px',
                                                                        border: '3px solid white',
                                                                        borderRadius: '10px',
                                                                        fontSize: '1.1rem',
                                                                        background: 'white',
                                                                        color: '#1f2937',
                                                                        fontWeight: '600',
                                                                        textAlign: 'center'
                                                                    }
                                                                })
                                                            ),
                                                            h('div', null,
                                                                h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '8px' } }, 'üéÆ Pessoas no Jogo Atendendo'),
                                                                h('input', {
                                                                    type: 'number',
                                                                    min: '0',
                                                                    value: checklistFormState.pessoasJogo || '',
                                                                    onChange: (e) => setChecklistFormState({...checklistFormState, pessoasJogo: e.target.value}),
                                                                    style: {
                                                                        width: '100%',
                                                                        padding: '16px',
                                                                        border: '3px solid white',
                                                                        borderRadius: '10px',
                                                                        fontSize: '1.1rem',
                                                                        background: 'white',
                                                                        color: '#1f2937',
                                                                        fontWeight: '600',
                                                                        textAlign: 'center'
                                                                    }
                                                                })
                                                            ),
                                                            h('div', null,
                                                                h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '8px' } }, 'üéØ Metas Batidas at√© Hoje'),
                                                                h('input', {
                                                                    type: 'number',
                                                                    min: '0',
                                                                    value: checklistFormState.metasBatidas || '',
                                                                    onChange: (e) => setChecklistFormState({...checklistFormState, metasBatidas: e.target.value}),
                                                                    style: {
                                                                        width: '100%',
                                                                        padding: '16px',
                                                                        border: '3px solid white',
                                                                        borderRadius: '10px',
                                                                        fontSize: '1.1rem',
                                                                        background: 'white',
                                                                        color: '#1f2937',
                                                                        fontWeight: '600',
                                                                        textAlign: 'center'
                                                                    }
                                                                })
                                                            ),
                                                            h('div', null,
                                                                h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '8px' } }, '‚≠ê Desempenho Geral da Equipe'),
                                                                h('select', {
                                                                    value: checklistFormState.desempenho || '',
                                                                    onChange: (e) => setChecklistFormState({...checklistFormState, desempenho: e.target.value}),
                                                                    style: {
                                                                        width: '100%',
                                                                        padding: '16px',
                                                                        border: '3px solid white',
                                                                        borderRadius: '10px',
                                                                        fontSize: '1.1rem',
                                                                        background: 'white',
                                                                        color: '#1f2937',
                                                                        fontWeight: '600'
                                                                    }
                                                                },
                                                                    h('option', { value: '' }, 'Avalie o desempenho...'),
                                                                    h('option', { value: 'ruim' }, '‚ùå Ruim'),
                                                                    h('option', { value: 'regular' }, '‚ö†Ô∏è Regular'),
                                                                    h('option', { value: 'bom' }, '‚úÖ Bom'),
                                                                    h('option', { value: 'excelente' }, 'üèÜ Excelente')
                                                                )
                                                            )
                                                        ),
                                                        // Se√ß√£o adicional para observa√ß√µes gerais da equipe
                                                        h('div', { style: { marginTop: '32px', padding: '24px', background: 'rgba(255, 255, 255, 0.15)', borderRadius: '16px' } },
                                                            h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '12px', fontSize: '1.2rem' } }, 'üìù Observa√ß√µes Gerais da Equipe'),
                                                            h('textarea', {
                                                                value: checklistFormState.observacoesGerais || '',
                                                                onChange: (e) => setChecklistFormState({...checklistFormState, observacoesGerais: e.target.value}),
                                                                style: {
                                                                    width: '100%',
                                                                    padding: '16px',
                                                                    border: '3px solid rgba(255, 255, 255, 0.4)',
                                                                    borderRadius: '12px',
                                                                    fontSize: '1rem',
                                                                    background: 'rgba(255, 255, 255, 0.2)',
                                                                    color: 'white',
                                                                    fontFamily: 'inherit',
                                                                    resize: 'vertical',
                                                                    minHeight: '120px'
                                                                },
                                                                placeholder: 'Descreva o estado geral da equipe, pontos fortes, √°reas de melhoria, problemas identificados...'
                                                            })
                                                        )
                                                    )
                                                ) : (
                                                    // RP Checklist - Perguntas espec√≠ficas COMPLETAS
                                                    h('div', { style: { background: 'linear-gradient(135deg, #8b5cf6, #7c3aed)', padding: '32px', borderRadius: '16px', color: 'white' } },
                                                        h('h3', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '24px' } }, 'üé≠ AN√ÅLISE COMPLETA DO SETOR ROLEPLAY'),
                                                        h('div', { style: { display: 'grid', gap: '28px' } },
                                                            [
                                                                'üè¢ A estrutura f√≠sica do setor est√° funcional e adequada?',
                                                                'üë• A equipe est√° ativa e presente regularmente?',
                                                                'üéØ O uso das fun√ß√µes espec√≠ficas do RP est√° sendo feito corretamente?',
                                                                'üìû A comunica√ß√£o externa (com outros setores) est√° funcionando bem?',
                                                                'üìã Os registros e documentos est√£o sendo atualizados regularmente?',
                                                                '‚è∞ Os hor√°rios de funcionamento est√£o sendo respeitados?',
                                                                'üí∞ As transa√ß√µes financeiras est√£o sendo registradas adequadamente?',
                                                                'üé≠ O roleplay est√° sendo executado com qualidade e realismo?',
                                                                'üìä Os funcion√°rios est√£o cumprindo suas metas di√°rias/semanais?',
                                                                'üîÑ Houve melhorias implementadas desde a √∫ltima auditoria?',
                                                                '‚ö†Ô∏è Existem problemas ou conflitos internos na equipe?',
                                                                'üìà O setor est√° gerando lucro/resultados esperados?',
                                                                'üéØ As diretrizes da cidade est√£o sendo seguidas corretamente?',
                                                                'ü§ù A colabora√ß√£o com outros setores est√° funcionando bem?',
                                                                'üîß H√° necessidade de treinamento ou capacita√ß√£o da equipe?'
                                                            ].map((pergunta, index) =>
                                                                h('div', { key: index, style: { padding: '24px', background: 'rgba(255, 255, 255, 0.15)', borderRadius: '16px', border: '2px solid rgba(255, 255, 255, 0.3)' } },
                                                                    h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '16px', fontSize: '1.2rem', lineHeight: '1.4' } }, 
                                                                        `${index + 1}. ${pergunta}`
                                                                    ),
                                                                    h('div', { style: { display: 'flex', gap: '20px', marginBottom: '16px', flexWrap: 'wrap' } },
                                                                        [
                                                                            { value: 'excelente', label: 'üèÜ Excelente', color: '#10b981' },
                                                                            { value: 'bom', label: '‚úÖ Bom', color: '#059669' },
                                                                            { value: 'regular', label: '‚ö†Ô∏è Regular', color: '#f59e0b' },
                                                                            { value: 'ruim', label: '‚ùå Ruim', color: '#dc2626' },
                                                                            { value: 'nao_verificado', label: '‚ùì N√£o Verificado', color: '#6b7280' }
                                                                        ].map(opcao => 
                                                                            h('label', { 
                                                                                key: opcao.value,
                                                                                style: { 
                                                                                    display: 'flex', 
                                                                                    alignItems: 'center',
                                                                                    gap: '10px',
                                                                                    cursor: 'pointer',
                                                                                    fontSize: '1rem',
                                                                                    padding: '12px 18px',
                                                                                    borderRadius: '12px',
                                                                                    background: checklistFormState[`pergunta_${index}`] === opcao.value ? 'rgba(255, 255, 255, 0.35)' : 'rgba(255, 255, 255, 0.1)',
                                                                                    border: '3px solid ' + (checklistFormState[`pergunta_${index}`] === opcao.value ? 'white' : 'rgba(255, 255, 255, 0.3)'),
                                                                                    fontWeight: '600',
                                                                                    transition: 'all 0.2s',
                                                                                    minWidth: '140px'
                                                                                }
                                                                            },
                                                                                h('input', {
                                                                                    type: 'radio',
                                                                                    name: `pergunta_${index}`,
                                                                                    value: opcao.value,
                                                                                    checked: checklistFormState[`pergunta_${index}`] === opcao.value,
                                                                                    onChange: (e) => setChecklistFormState({...checklistFormState, [`pergunta_${index}`]: e.target.value}),
                                                                                    style: { margin: 0, transform: 'scale(1.3)' }
                                                                                }),
                                                                                h('span', { style: { color: 'white', fontWeight: '700' } }, opcao.label)
                                                                            )
                                                                        )
                                                                    ),
                                                                    h('textarea', {
                                                                        value: checklistFormState[`obs_${index}`] || '',
                                                                        onChange: (e) => setChecklistFormState({...checklistFormState, [`obs_${index}`]: e.target.value}),
                                                                        style: {
                                                                            width: '100%',
                                                                            padding: '16px',
                                                                            border: '3px solid rgba(255, 255, 255, 0.4)',
                                                                            borderRadius: '12px',
                                                                            fontSize: '1rem',
                                                                            background: 'rgba(255, 255, 255, 0.2)',
                                                                            color: 'white',
                                                                            fontFamily: 'inherit',
                                                                            resize: 'vertical',
                                                                            minHeight: '100px',
                                                                            lineHeight: '1.5'
                                                                        },
                                                                        placeholder: `Observa√ß√µes detalhadas sobre: ${pergunta.replace(/üî∏|üîπ|üìã|üë•|üéØ|üìû|‚è∞|üí∞|üé≠/g, '').trim()}...`
                                                                    })
                                                                )
                                                            )
                                                        ),
                                                        // Se√ß√£o final para resumo geral do setor RP
                                                        h('div', { style: { marginTop: '32px', padding: '28px', background: 'rgba(255, 255, 255, 0.2)', borderRadius: '20px', border: '3px solid rgba(255, 255, 255, 0.4)' } },
                                                            h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '16px', fontSize: '1.4rem' } }, 'üìã RESUMO GERAL DO SETOR'),
                                                            h('textarea', {
                                                                value: checklistFormState.resumoGeralSetor || '',
                                                                onChange: (e) => setChecklistFormState({...checklistFormState, resumoGeralSetor: e.target.value}),
                                                                style: {
                                                                    width: '100%',
                                                                    padding: '20px',
                                                                    border: '3px solid rgba(255, 255, 255, 0.5)',
                                                                    borderRadius: '16px',
                                                                    fontSize: '1.1rem',
                                                                    background: 'rgba(255, 255, 255, 0.25)',
                                                                    color: 'white',
                                                                    fontFamily: 'inherit',
                                                                    resize: 'vertical',
                                                                    minHeight: '150px',
                                                                    lineHeight: '1.6'
                                                                },
                                                                placeholder: 'Fa√ßa um resumo completo do estado atual do setor: pontos fortes, problemas encontrados, sugest√µes de melhoria, impress√£o geral...'
                                                            })
                                                        )
                                                    )
                                                ),

                                                // Confirma√ß√µes de painel
                                                h('div', { style: { background: 'linear-gradient(135deg, #dc2626, #b91c1c)', padding: '32px', borderRadius: '16px', color: 'white' } },
                                                    h('h3', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '24px' } }, 'üìä PAINEL ONLINE (OBRIGAT√ìRIO)'),
                                                    h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '24px' } },
                                                        ['manha', 'tarde', 'noite'].map(turno => {
                                                            const labels = { manha: 'üåÖ Manh√£', tarde: '‚òÄÔ∏è Tarde', noite: 'üåô Noite' };
                                                            const isCompleted = currentChecklistState.confirmacoesPainel[turno] !== '';
                                                            return h('div', { key: turno },
                                                                h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '8px' } }, labels[turno]),
                                                                h('input', {
                                                                    type: 'number',
                                                                    min: '0',
                                                                    value: currentChecklistState.confirmacoesPainel[turno] || '',
                                                                    onChange: (e) => {
                                                                        setCurrentChecklistState({
                                                                            ...currentChecklistState,
                                                                            confirmacoesPainel: {
                                                                                ...currentChecklistState.confirmacoesPainel,
                                                                                [turno]: e.target.value
                                                                            }
                                                                        });
                                                                    },
                                                                    style: {
                                                                        width: '100%',
                                                                        padding: '14px',
                                                                        border: `2px solid ${isCompleted ? '#10b981' : 'white'}`,
                                                                        borderRadius: '8px',
                                                                        fontSize: '1rem',
                                                                        background: isCompleted ? '#f0fdf4' : 'white',
                                                                        color: '#1f2937',
                                                                        fontWeight: '500',
                                                                        textAlign: 'center'
                                                                    },
                                                                    placeholder: '0'
                                                                })
                                                            );
                                                        })
                                                    ),
                                                    h('div', { style: { textAlign: 'center', marginTop: '20px' } },
                                                        Object.values(currentChecklistState.confirmacoesPainel).every(val => val !== '') ?
                                                            h('p', { style: { color: '#10b981', fontWeight: '700', fontSize: '1.2rem' } }, '‚úÖ TODOS OS TURNOS CONFIRMADOS!') :
                                                            h('p', { style: { color: '#fbbf24', fontWeight: '700', fontSize: '1.2rem' } }, 
                                                                `‚è≥ FALTAM ${Object.values(currentChecklistState.confirmacoesPainel).filter(val => val === '').length} TURNO(S)`
                                                            )
                                                    )
                                                ),

                                                // Bot√µes de a√ß√£o
                                                h('div', { style: { display: 'flex', justifyContent: 'center', gap: '24px', padding: '32px' } },
                                                    h('button', {
                                                        onClick: saveChecklistData,
                                                        style: {
                                                            background: Object.values(currentChecklistState.confirmacoesPainel).every(val => val !== '') ? '#16a34a' : '#f59e0b',
                                                            color: 'white',
                                                            padding: '18px 40px',
                                                            border: 'none',
                                                            borderRadius: '12px',
                                                            cursor: 'pointer',
                                                            fontWeight: '700',
                                                            fontSize: '1.2rem'
                                                        }
                                                    },
                                                        Object.values(currentChecklistState.confirmacoesPainel).every(val => val !== '') ?
                                                            'üì§ ENVIAR PARA APROVA√á√ÉO' : 'üíæ SALVAR COMO RASCUNHO'
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            );
                        }

                        return h('div', { style: { minHeight: '100vh', background: '#f8fafc' } },
                            h(Header),
                            h('div', { style: { display: 'flex' } },
                                h(Sidebar),
                                h('main', { style: { flex: 1, padding: '40px' } },
                                    h('h2', { style: { fontSize: '2.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '32px' } }, 'Checklist'),
                                    
                                    // Cards para criar novos checklists
                                    h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '24px', marginBottom: '40px' } },
                                        h('div', {
                                            onClick: () => startNewChecklist('staff'),
                                            style: {
                                                background: 'linear-gradient(135deg, #3b82f6, #1d4ed8)',
                                                color: 'white',
                                                padding: '32px',
                                                borderRadius: '16px',
                                                cursor: 'pointer',
                                                textAlign: 'center'
                                            }
                                        },
                                            h('div', { style: { fontSize: '4rem', marginBottom: '16px' } }, 'üë•'),
                                            h('h3', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '8px' } }, 'Checklist Staff'),
                                            h('p', { style: { opacity: 0.9, fontSize: '1.1rem' } }, 'Auditoria das equipes Discord - 50 pontos')
                                        ),
                                        h('div', {
                                            onClick: () => startNewChecklist('rp'),
                                            style: {
                                                background: 'linear-gradient(135deg, #10b981, #059669)',
                                                color: 'white',
                                                padding: '32px',
                                                borderRadius: '16px',
                                                cursor: 'pointer',
                                                textAlign: 'center'
                                            }
                                        },
                                            h('div', { style: { fontSize: '4rem', marginBottom: '16px' } }, 'üé≠'),
                                            h('h3', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '8px' } }, 'Checklist Roleplay'),
                                            h('p', { style: { opacity: 0.9, fontSize: '1.1rem' } }, 'Auditoria dos setores RP - 50 pontos')
                                        )
                                    ),

                                    // Lista de checklists existentes
                                    h('div', { style: { background: 'white', borderRadius: '16px', padding: '32px', boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)' } },
                                        h('h3', { style: { fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '24px' } }, 'Meus Checklists'),
                                        pendingUsers.length > 0 && h('div', { style: { display: 'grid', gap: '16px' } },
                                            checklists
                                                .filter(c => c.autorId === currentUser.id)
                                                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                                                .slice(0, 10)
                                                .map(checklist => 
                                                    h('div', {
                                                        key: checklist.id,
                                                        style: {
                                                            display: 'flex',
                                                            justifyContent: 'space-between',
                                                            alignItems: 'center',
                                                            padding: '24px',
                                                            border: '2px solid #e5e7eb',
                                                            borderRadius: '16px',
                                                            background: '#fafafa',
                                                            borderLeft: `6px solid ${checklist.status === 'aprovado' ? '#16a34a' : checklist.status === 'aguardando_aprovacao' ? '#f59e0b' : '#3b82f6'}`
                                                        }
                                                    },
                                                        h('div', { style: { flex: 1 } },
                                                            h('p', { style: { fontWeight: '700', color: '#1f2937', fontSize: '1.2rem', margin: '0 0 8px 0' } },
                                                                `${checklist.tipo === 'staff' ? 'STAFF' : 'ROLEPLAY'} - ${checklist.equipe || checklist.setor}`
                                                            ),
                                                            h('p', { style: { color: '#6b7280', fontSize: '0.9rem', margin: '4px 0' } },
                                                                `üìÖ Criado: ${new Date(checklist.createdAt).toLocaleDateString('pt-BR')}`
                                                            ),
                                                            checklist.subsetor && h('p', { style: { color: '#6b7280', fontSize: '0.9rem', margin: 0 } },
                                                                `üöî Subsetor: ${checklist.subsetor}`
                                                            )
                                                        ),
                                                        h('div', { style: { display: 'flex', alignItems: 'center', gap: '16px' } },
                                                            h('span', {
                                                                style: {
                                                                    padding: '10px 20px',
                                                                    borderRadius: '25px',
                                                                    fontSize: '0.9rem',
                                                                    fontWeight: '700',
                                                                    ...(checklist.status === 'aprovado' ? {
                                                                        background: '#dcfce7',
                                                                        color: '#16a34a',
                                                                        border: '2px solid #16a34a'
                                                                    } : checklist.status === 'aguardando_aprovacao' ? {
                                                                        background: '#fef3c7',
                                                                        color: '#d97706',
                                                                        border: '2px solid #f59e0b'
                                                                    } : {
                                                                        background: '#dbeafe',
                                                                        color: '#2563eb',
                                                                        border: '2px solid #3b82f6'
                                                                    })
                                                                }
                                                            }, checklist.status === 'aprovado' ? '‚úÖ APROVADO' : 
                                                               checklist.status === 'aguardando_aprovacao' ? '‚è≥ AGUARDANDO' : 
                                                               'üìù EM ANDAMENTO'),
                                                            checklist.status === 'em_andamento' && h('button', {
                                                                onClick: () => {
                                                                    setCurrentChecklistState(checklist);
                                                                    setChecklistFormState(checklist);
                                                                },
                                                                style: {
                                                                    background: '#3b82f6',
                                                                    color: 'white',
                                                                    padding: '12px 20px',
                                                                    border: 'none',
                                                                    borderRadius: '8px',
                                                                    cursor: 'pointer',
                                                                    fontWeight: '600'
                                                                }
                                                            }, 'üìù Continuar')
                                                        )
                                                    )
                                                )
                                        )
                                    )
                                )
                            )
                        );
                    };

                    // P√°gina de Auditoria - SISTEMA ULTRA COMPLETO RESTAURADO
                    const AuditoriaPage = () => {
                        const [currentAuditoriaState, setCurrentAuditoriaState] = useState(null);
                        const [auditoriaFormState, setAuditoriaFormState] = useState({});

                        const startNewAuditoria = (tipo) => {
                            const newAuditoria = {
                                id: Date.now(),
                                tipo,
                                autorId: currentUser.id,
                                status: 'em_andamento',
                                createdAt: new Date().toISOString(),
                                etapaAtual: 1
                            };
                            setCurrentAuditoriaState(newAuditoria);
                            setAuditoriaFormState({});
                        };

                        const saveAuditoriaData = () => {
                            if (!auditoriaFormState.setor || !auditoriaFormState.turno) {
                                alert('‚ö†Ô∏è Preencha todos os campos obrigat√≥rios!');
                                return;
                            }

                            if (!auditoriaFormState.relatorioFinal || auditoriaFormState.relatorioFinal.length < 100) {
                                alert('‚ö†Ô∏è O relat√≥rio deve ter pelo menos 100 caracteres!');
                                return;
                            }

                            // Calcular dura√ß√£o automaticamente
                            const inicioTimestamp = new Date(currentAuditoriaState.createdAt);
                            const fimTimestamp = new Date();
                            const diferencaMs = fimTimestamp - inicioTimestamp;
                            const duracaoCalculada = calcularDuracaoFormatada(diferencaMs);

                            const updatedAuditoria = {
                                ...currentAuditoriaState,
                                ...auditoriaFormState,
                                updatedAt: fimTimestamp.toISOString(),
                                status: 'aguardando_aprovacao',
                                duracaoAutomatica: duracaoCalculada,
                                tempoInicioMs: inicioTimestamp.getTime(),
                                tempoFimMs: fimTimestamp.getTime(),
                                duracaoTotalMs: diferencaMs
                            };

                            const existingIndex = auditorias.findIndex(a => a.id === currentAuditoriaState.id);
                            if (existingIndex >= 0) {
                                setAuditorias(auditorias.map(a => a.id === currentAuditoriaState.id ? updatedAuditoria : a));
                            } else {
                                setAuditorias([...auditorias, updatedAuditoria]);
                            }

                            setCurrentAuditoriaState(null);
                            setAuditoriaFormState({});
                            alert(`‚úÖ AUDITORIA COMPLETA enviada para aprova√ß√£o!\n‚è±Ô∏è Dura√ß√£o total: ${updatedAuditoria.duracaoAutomatica}`);
                        };

                        if (currentAuditoriaState) {
                            return h('div', { style: { minHeight: '100vh', background: '#f8fafc' } },
                                h(Header),
                                h('div', { style: { display: 'flex' } },
                                    h(Sidebar),
                                    h('main', { style: { flex: 1, padding: '40px', maxWidth: '1600px', margin: '0 auto' } },
                                        h('div', { style: { background: 'white', borderRadius: '16px', padding: '40px', boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)' } },
                                            h('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '40px' } },
                                                h('h2', { style: { fontSize: '2.8rem', fontWeight: 'bold', color: '#1f2937', margin: 0 } }, 
                                                    `üîç AUDITORIA ${currentAuditoriaState.tipo === 'staff' ? 'STAFF' : 'ROLEPLAY'}`
                                                ),
                                                h('button', {
                                                    onClick: () => setCurrentAuditoriaState(null),
                                                    style: {
                                                        background: '#6b7280',
                                                        color: 'white',
                                                        padding: '14px 28px',
                                                        border: 'none',
                                                        borderRadius: '10px',
                                                        cursor: 'pointer',
                                                        fontWeight: '700'
                                                    }
                                                }, '‚ùå Cancelar')
                                            ),
                                            
                                            h('div', { style: { display: 'grid', gap: '40px' } },
                                                // Se√ß√£o 1: Dados b√°sicos da auditoria
                                                h('div', { style: { background: 'linear-gradient(135deg, #3b82f6, #1e40af)', padding: '36px', borderRadius: '20px', color: 'white' } },
                                                    h('h3', { style: { fontSize: '2rem', fontWeight: 'bold', marginBottom: '28px' } }, 'üìã DADOS DA AUDITORIA'),
                                                    
                                                    h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '28px' } },
                                                        h('div', null,
                                                            h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '10px', fontSize: '1.2rem' } }, 
                                                                currentAuditoriaState.tipo === 'staff' ? 'üè¢ Equipe Staff' : 'üèõÔ∏è Setor RP'
                                                            ),
                                                            h('select', {
                                                                value: auditoriaFormState.setor || '',
                                                                onChange: (e) => setAuditoriaFormState({...auditoriaFormState, setor: e.target.value}),
                                                                style: {
                                                                    width: '100%',
                                                                    padding: '16px',
                                                                    border: '3px solid white',
                                                                    borderRadius: '10px',
                                                                    fontSize: '1.1rem',
                                                                    background: 'white',
                                                                    color: '#1f2937',
                                                                    fontWeight: '600'
                                                                }
                                                            },
                                                                h('option', { value: '' }, currentAuditoriaState.tipo === 'staff' ? 'Selecione a equipe...' : 'Selecione o setor...'),
                                                                (currentAuditoriaState.tipo === 'staff' 
                                                                    ? ['Alta C√∫pula', 'ADM Staff', 'RESP Comunidade', 'Mentoria', 'Equipe Legal', 'Social Media', 'Comercial', 'Ticketing', 'Eventos']
                                                                    : ['Jur√≠dico', 'Prefeitura', 'Igreja', 'Jornal', 'Hospital', 'Bombeiros', 'Mec√¢nica', 'Empres√°rios', 'Fac√ß√£o', 'M√°fia', 'Pol√≠cia']
                                                                ).map(item => h('option', { key: item, value: item }, item))
                                                            )
                                                        ),
                                                        // Campo subsetor para Pol√≠cia na Auditoria - IMPLEMENTADO!
                                                        auditoriaFormState.setor === 'Pol√≠cia' && h('div', null,
                                                            h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '10px', fontSize: '1.2rem' } }, 'üöî Subsetor da Pol√≠cia'),
                                                            h('select', {
                                                                value: auditoriaFormState.subsetor || '',
                                                                onChange: (e) => setAuditoriaFormState({...auditoriaFormState, subsetor: e.target.value}),
                                                                style: {
                                                                    width: '100%',
                                                                    padding: '16px',
                                                                    border: '3px solid white',
                                                                    borderRadius: '10px',
                                                                    fontSize: '1.1rem',
                                                                    background: 'white',
                                                                    color: '#1f2937',
                                                                    fontWeight: '600'
                                                                }
                                                            },
                                                                h('option', { value: '' }, 'Selecione o subsetor...'),
                                                                ['PRF', 'Federal', 'Civil', 'Militar', 'Pris√£o', 'BOPE', 'MPF', 'Seguran√ßa Jur√≠dica'].map(sub => 
                                                                    h('option', { key: sub, value: sub }, sub)
                                                                )
                                                            )
                                                        ),
                                                        h('div', null,
                                                            h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '10px', fontSize: '1.2rem' } }, 'üïê Turno'),
                                                            h('select', {
                                                                value: auditoriaFormState.turno || '',
                                                                onChange: (e) => setAuditoriaFormState({...auditoriaFormState, turno: e.target.value}),
                                                                style: {
                                                                    width: '100%',
                                                                    padding: '16px',
                                                                    border: '3px solid white',
                                                                    borderRadius: '10px',
                                                                    fontSize: '1.1rem',
                                                                    background: 'white',
                                                                    color: '#1f2937',
                                                                    fontWeight: '600'
                                                                }
                                                            },
                                                                h('option', { value: '' }, 'Selecione o turno...'),
                                                                h('option', { value: 'manha' }, 'üåÖ Manh√£ (06:00 - 14:00)'),
                                                                h('option', { value: 'tarde' }, '‚òÄÔ∏è Tarde (14:00 - 22:00)'),
                                                                h('option', { value: 'noite' }, 'üåô Noite (22:00 - 06:00)')
                                                            )
                                                        ),
                                                        h('div', null,
                                                            h('label', { style: { display: 'block', fontWeight: '700', color: 'white', marginBottom: '10px', fontSize: '1.2rem' } }, '‚è∞ Dura√ß√£o'),
                                                            h('div', {
                                                                style: {
                                                                    width: '100%',
                                                                    padding: '16px',
                                                                    border: '3px solid white',
                                                                    borderRadius: '10px',
                                                                    fontSize: '1.1rem',
                                                                    background: 'white',
                                                                    color: '#1f2937',
                                                                    fontWeight: '600',
                                                                    textAlign: 'center'
                                                                }
                                                            }, 'ü§ñ Calculado Automaticamente'),
                                                            h('p', { style: { fontSize: '0.9rem', color: 'rgba(255, 255, 255, 0.8)', marginTop: '8px', textAlign: 'center', fontStyle: 'italic' } }, 
                                                                '‚ö° Sistema calcula baseado nos timestamps'
                                                            )
                                                        )
                                                    )
                                                ),

                                                // Se√ß√£o 2: Perguntas gerais para RP (TODAS as auditorias RP)
                                                currentAuditoriaState.tipo === 'roleplay' && h('div', { style: { background: 'linear-gradient(135deg, #10b981, #059669)', padding: '32px', borderRadius: '16px', color: 'white' } },
                                                    h('h3', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '24px' } }, 'üé≠ PERGUNTAS GERAIS - AUDITORIA ROLEPLAY'),
                                                    h('div', { style: { display: 'grid', gap: '28px' } },
                                                        [
                                                            'üè¢ A estrutura f√≠sica do setor est√° funcional e adequada?',
                                                            'üë• A equipe est√° ativa e presente regularmente?', 
                                                            'üéØ O uso das fun√ß√µes espec√≠ficas do RP est√° sendo feito corretamente?',
                                                            'üìû A comunica√ß√£o externa (com outros setores) est√° funcionando bem?',
                                                            'üìã Os registros e documentos est√£o sendo atualizados regularmente?',
                                                            '‚è∞ Os hor√°rios de funcionamento est√£o sendo respeitados?',
                                                            'üí∞ As transa√ß√µes financeiras est√£o sendo registradas adequadamente?',
                                                            'üé≠ O roleplay est√° sendo executado com qualidade e realismo?'
                                                        ].map((pergunta, index) =>
                                                            h('div', { key: `geral_${index}`, style: { padding: '24px', background: 'rgba(255, 255, 255, 0.15)', borderRadius: '16px' } },
                                                                h('label', { style: { display: 'block', color: 'white', fontWeight: '700', marginBottom: '18px', fontSize: '1.2rem' } }, 
                                                                    `${index + 1}. ${pergunta}`
                                                                ),
                                                                h('div', { style: { display: 'flex', gap: '18px', flexWrap: 'wrap', marginBottom: '18px' } },
                                                                    ['excelente', 'bom', 'regular', 'ruim', 'nao_verificado'].map(opcao => {
                                                                        const labels = { 
                                                                            excelente: 'üèÜ Excelente', 
                                                                            bom: '‚úÖ Bom', 
                                                                            regular: '‚ö†Ô∏è Regular', 
                                                                            ruim: '‚ùå Ruim',
                                                                            nao_verificado: '‚ùì N√£o Verificado'
                                                                        };
                                                                        return h('label', { 
                                                                            key: opcao,
                                                                            style: { 
                                                                                display: 'flex', 
                                                                                alignItems: 'center',
                                                                                gap: '12px',
                                                                                cursor: 'pointer',
                                                                                fontSize: '1rem',
                                                                                padding: '14px 20px',
                                                                                borderRadius: '12px',
                                                                                background: auditoriaFormState[`geral_${index}`] === opcao ? 'rgba(255, 255, 255, 0.35)' : 'rgba(255, 255, 255, 0.15)',
                                                                                border: '3px solid ' + (auditoriaFormState[`geral_${index}`] === opcao ? 'white' : 'rgba(255, 255, 255, 0.4)'),
                                                                                fontWeight: '600'
                                                                            }
                                                                        },
                                                                            h('input', {
                                                                                type: 'radio',
                                                                                name: `geral_${index}`,
                                                                                value: opcao,
                                                                                checked: auditoriaFormState[`geral_${index}`] === opcao,
                                                                                onChange: (e) => setAuditoriaFormState({...auditoriaFormState, [`geral_${index}`]: e.target.value}),
                                                                                style: { margin: 0, transform: 'scale(1.4)' }
                                                                            }),
                                                                            h('span', { style: { color: 'white', fontWeight: '700' } }, labels[opcao])
                                                                        );
                                                                    })
                                                                ),
                                                                h('textarea', {
                                                                    value: auditoriaFormState[`obs_geral_${index}`] || '',
                                                                    onChange: (e) => setAuditoriaFormState({...auditoriaFormState, [`obs_geral_${index}`]: e.target.value}),
                                                                    style: {
                                                                        width: '100%',
                                                                        padding: '16px',
                                                                        border: '3px solid rgba(255, 255, 255, 0.4)',
                                                                        borderRadius: '12px',
                                                                        fontSize: '1rem',
                                                                        background: 'rgba(255, 255, 255, 0.2)',
                                                                        color: 'white',
                                                                        fontFamily: 'inherit',
                                                                        resize: 'vertical',
                                                                        minHeight: '100px'
                                                                    },
                                                                    placeholder: `Observa√ß√µes detalhadas sobre: ${pergunta}...`
                                                                })
                                                            )
                                                        )
                                                    )
                                                ),

                                                // Se√ß√£o para auditoria Staff - Perguntas gerais
                                                currentAuditoriaState.tipo === 'staff' && (() => {
                                                    const equipeSelecionada = auditoriaFormState.setor;
                                                    let perguntasEspecificas = [];
                                                    let tituloSecaoStaff = '';
                                                    let corSecaoStaff = '#8b5cf6';

                                                    if (equipeSelecionada === 'Comercial') {
                                                        tituloSecaoStaff = 'üíº AUDITORIA STAFF COMERCIAL - PERGUNTAS ESPEC√çFICAS';
                                                        corSecaoStaff = '#059669';
                                                        perguntasEspecificas = [
                                                            { q: 'A equipe tem metas claras de venda definidas semanal ou mensalmente?', key: 'metasVendaDefinidas' },
                                                            { q: 'H√° acompanhamento dos atendimentos realizados por cada membro?', key: 'acompanhamentoAtendimentos' },
                                                            { q: 'Existe planilha ou sistema com registro das vendas?', key: 'sistemaRegistroVendas' },
                                                            { q: 'Os produtos ou servi√ßos est√£o sendo divulgados corretamente dentro dos canais da cidade?', key: 'divulgacaoCorreta' },
                                                            { q: 'A equipe conhece bem os servi√ßos da cidade e sabe argumentar com os cidad√£os?', key: 'conhecimentoServicos' },
                                                            { q: 'Existe supervis√£o ativa para evitar promessas falsas ou condutas abusivas?', key: 'supervisaoAtiva' },
                                                            { q: 'Foi feita alguma capacita√ß√£o recente de abordagem ou t√©cnica de venda?', key: 'capacitacaoRecente' }
                                                        ];
                                                    } else if (equipeSelecionada === 'Social Media') {
                                                        tituloSecaoStaff = 'üì¢ AUDITORIA STAFF SOCIAL MEDIA - PERGUNTAS ESPEC√çFICAS';
                                                        corSecaoStaff = '#f59e0b';
                                                        perguntasEspecificas = [
                                                            { q: 'Todos os membros da SM est√£o utilizando as ferramentas corretas (ex: painel de clipping, agendamento de postagens, etc)?', key: 'ferramentasCorretas' },
                                                            { q: 'Est√£o sendo entregues conte√∫dos peri√≥dicos e alinhados com os acontecimentos da cidade?', key: 'conteudosPeriodicosAlinhados' },
                                                            { q: 'As artes e os textos seguem a identidade visual da cidade Ilusion?', key: 'identidadeVisual' },
                                                            { q: 'A equipe est√° cobrindo eventos importantes e registrando adequadamente (fotos, v√≠deos, lives)?', key: 'coberturaEventos' },
                                                            { q: 'As contas oficiais est√£o sendo monitoradas com frequ√™ncia?', key: 'monitoramentoContas' },
                                                            { q: 'Os feedbacks da popula√ß√£o est√£o sendo coletados ou respondidos?', key: 'feedbackPopulacao' },
                                                            { q: 'Existe uma divis√£o clara entre quem cuida de texto, imagem, v√≠deo e postagem?', key: 'divisaoFuncoes' }
                                                        ];
                                                    } else if (equipeSelecionada === 'Ticketing') {
                                                        tituloSecaoStaff = 'üéüÔ∏è AUDITORIA STAFF TICKETING - PERGUNTAS ESPEC√çFICAS';
                                                        corSecaoStaff = '#dc2626';
                                                        perguntasEspecificas = [
                                                            { q: 'O tempo m√©dio de resposta est√° dentro do aceit√°vel?', key: 'tempoRespostaAceitavel' },
                                                            { q: 'Os tickets est√£o sendo respondidos com profissionalismo e clareza?', key: 'respostasProfissionais' },
                                                            { q: 'H√° algu√©m respons√°vel por revisar tickets mais sens√≠veis (conflitos, den√∫ncias)?', key: 'revisaoTicketsSensiveis' },
                                                            { q: 'Existe sistema de triagem por tipo de ticket (RP, den√∫ncia, d√∫vida, suporte t√©cnico)?', key: 'sistemaTriagem' },
                                                            { q: 'A equipe est√° utilizando o hist√≥rico dos tickets para evitar respostas duplicadas?', key: 'usoHistorico' },
                                                            { q: 'Os membros est√£o atualizados quanto √†s normas da cidade antes de responder?', key: 'atualizacaoNormas' }
                                                        ];
                                                    } else if (equipeSelecionada === 'Eventos') {
                                                        tituloSecaoStaff = 'üé™ AUDITORIA STAFF EVENTOS - PERGUNTAS ESPEC√çFICAS';
                                                        corSecaoStaff = '#8b5cf6';
                                                        perguntasEspecificas = [
                                                            { q: 'A equipe est√° propondo eventos com frequ√™ncia?', key: 'propostaEventosFrequencia' },
                                                            { q: 'Os eventos est√£o sendo registrados no painel e no cronograma da cidade?', key: 'registroEventosPainel' },
                                                            { q: 'H√° divis√£o de fun√ß√µes entre organiza√ß√£o, divulga√ß√£o e execu√ß√£o?', key: 'divisaoFuncoesEventos' },
                                                            { q: 'Existe controle de presen√ßa e de problemas nos eventos realizados?', key: 'controlePresencaProblemas' },
                                                            { q: 'A equipe tem um respons√°vel pela log√≠stica de apoio (ex: fechar ruas, chamar seguran√ßa)?', key: 'responsavelLogistica' },
                                                            { q: 'Os eventos est√£o respeitando o tempo limite e as regras de conviv√™ncia?', key: 'respeitoRegrasEventos' },
                                                            { q: 'Est√£o fazendo relat√≥rios p√≥s-evento com avalia√ß√£o e sugest√µes?', key: 'relatoriosPosEvento' }
                                                        ];
                                                    } else if (equipeSelecionada === 'Equipe Legal') {
                                                        tituloSecaoStaff = '‚öñÔ∏è AUDITORIA STAFF EQUIPE LEGAL - PERGUNTAS ESPEC√çFICAS';
                                                        corSecaoStaff = '#1f2937';
                                                        perguntasEspecificas = [
                                                            { q: 'Todos os membros t√™m conhecimento das regras espec√≠ficas da cidade Ilusion?', key: 'conhecimentoRegrasEspecificas' },
                                                            { q: 'As decis√µes legais (demiss√µes, advert√™ncias, suspens√µes) est√£o sendo registradas corretamente?', key: 'registroDecisoesLegais' },
                                                            { q: 'H√° verifica√ß√£o dupla nas puni√ß√µes mais graves?', key: 'verificacaoDupla' },
                                                            { q: 'A equipe est√° mantendo comunica√ß√£o ativa com jur√≠dico e presid√™ncia?', key: 'comunicacaoJuridicoPresidencia' },
                                                            { q: 'Existem revis√µes regulares nos contratos ou documentos oficiais da cidade?', key: 'revisaoContratosDocumentos' },
                                                            { q: 'O painel est√° sendo atualizado com frequ√™ncia?', key: 'atualizacaoPainelLegal' },
                                                            { q: 'Os membros est√£o sabendo lidar com conflitos internos de forma √©tica e imparcial?', key: 'gerenciamentoConflitos' }
                                                        ];
                                                    }

                                                    if (perguntasEspecificas.length > 0) {
                                                        return h('div', { style: { padding: '32px', background: `linear-gradient(135deg, ${corSecaoStaff}55, ${corSecaoStaff}44)`, borderRadius: '24px', border: `4px solid ${corSecaoStaff}`, marginTop: '32px' } },
                                                            h('h4', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '28px', color: corSecaoStaff } }, tituloSecaoStaff),
                                                            h('div', { style: { display: 'grid', gap: '28px' } },
                                                                perguntasEspecificas.map((item, index) => 
                                                                    h('div', { key: `staff_especifica_${index}`, style: { padding: '24px', background: 'rgba(255, 255, 255, 0.2)', borderRadius: '16px' } },
                                                                        h('label', { style: { display: 'block', color: 'white', fontWeight: '700', marginBottom: '18px', fontSize: '1.3rem' } }, 
                                                                            `${index + 1}. ${item.q}`
                                                                        ),
                                                                        h('div', { style: { display: 'flex', gap: '18px', flexWrap: 'wrap', marginBottom: '18px' } },
                                                                            ['excelente', 'bom', 'regular', 'ruim', 'nao_verificado'].map(opcao => {
                                                                                const labels = { 
                                                                                    excelente: 'üèÜ Excelente', 
                                                                                    bom: '‚úÖ Bom', 
                                                                                    regular: '‚ö†Ô∏è Regular', 
                                                                                    ruim: '‚ùå Ruim',
                                                                                    nao_verificado: '‚ùì N√£o Verificado'
                                                                                };
                                                                                return h('label', { 
                                                                                    key: opcao,
                                                                                    style: { 
                                                                                        display: 'flex', 
                                                                                        alignItems: 'center',
                                                                                        gap: '12px',
                                                                                        cursor: 'pointer',
                                                                                        fontSize: '1rem',
                                                                                        padding: '14px 20px',
                                                                                        borderRadius: '12px',
                                                                                        background: auditoriaFormState[`staff_especifica_${item.key}`] === opcao ? 'rgba(255, 255, 255, 0.35)' : 'rgba(255, 255, 255, 0.15)',
                                                                                        border: '3px solid ' + (auditoriaFormState[`staff_especifica_${item.key}`] === opcao ? 'white' : 'rgba(255, 255, 255, 0.4)'),
                                                                                        fontWeight: '600'
                                                                                    }
                                                                                },
                                                                                    h('input', {
                                                                                        type: 'radio',
                                                                                        name: `staff_especifica_${item.key}`,
                                                                                        value: opcao,
                                                                                        checked: auditoriaFormState[`staff_especifica_${item.key}`] === opcao,
                                                                                        onChange: (e) => setAuditoriaFormState({...auditoriaFormState, [`staff_especifica_${item.key}`]: e.target.value}),
                                                                                        style: { margin: 0, transform: 'scale(1.4)' }
                                                                                    }),
                                                                                    h('span', { style: { color: 'white', fontWeight: '700' } }, labels[opcao])
                                                                                );
                                                                            })
                                                                        ),
                                                                        h('textarea', {
                                                                            value: auditoriaFormState[`obs_staff_${item.key}`] || '',
                                                                            onChange: (e) => setAuditoriaFormState({...auditoriaFormState, [`obs_staff_${item.key}`]: e.target.value}),
                                                                            style: {
                                                                                width: '100%',
                                                                                padding: '16px',
                                                                                border: '3px solid rgba(255, 255, 255, 0.4)',
                                                                                borderRadius: '12px',
                                                                                fontSize: '1rem',
                                                                                background: 'rgba(255, 255, 255, 0.2)',
                                                                                color: 'white',
                                                                                fontFamily: 'inherit',
                                                                                resize: 'vertical',
                                                                                minHeight: '100px'
                                                                            },
                                                                            placeholder: 'Observa√ß√µes espec√≠ficas sobre este aspecto...'
                                                                        })
                                                                    )
                                                                )
                                                            )
                                                        );
                                                    } else {
                                                        return h('div', { style: { padding: '28px', background: 'rgba(156, 163, 175, 0.2)', borderRadius: '20px', textAlign: 'center', marginTop: '32px' } },
                                                            h('p', { style: { color: 'rgba(255, 255, 255, 0.8)', fontSize: '1.2rem', fontWeight: '600' } }, 
                                                                `üì∞ Selecione "Comercial", "Social Media", "Ticketing", "Eventos" ou "Equipe Legal" para ver perguntas espec√≠ficas`
                                                            )
                                                        );
                                                    }
                                                })(),

                                                // Se√ß√£o para auditoria Staff - Perguntas gerais
                                                currentAuditoriaState.tipo === 'staff' && h('div', { style: { background: 'linear-gradient(135deg, #8b5cf6, #7c3aed)', padding: '32px', borderRadius: '16px', color: 'white' } },
                                                    h('h3', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '24px' } }, 'üë• PERGUNTAS GERAIS - AUDITORIA STAFF'),
                                                    h('div', { style: { display: 'grid', gap: '28px' } },
                                                        [
                                                            'üè¢ A estrutura organizacional da equipe est√° bem definida?',
                                                            '‚ö° Os membros respondem rapidamente aos chamados/tickets?',
                                                            'üìã Existe cumprimento das normas internas estabelecidas?',
                                                            'üéØ As metas da equipe est√£o sendo atingidas regularmente?',
                                                            'ü§ù H√° boa comunica√ß√£o e colabora√ß√£o entre os membros?',
                                                            'üîÑ A equipe se adapta bem √†s mudan√ßas e atualiza√ß√µes?',
                                                            'üìä Os relat√≥rios e documenta√ß√µes est√£o em dia?',
                                                            'üéì H√° necessidade de treinamento ou capacita√ß√£o?'
                                                        ].map((pergunta, index) =>
                                                            h('div', { key: `staff_geral_${index}`, style: { padding: '24px', background: 'rgba(255, 255, 255, 0.15)', borderRadius: '16px' } },
                                                                h('label', { style: { display: 'block', color: 'white', fontWeight: '700', marginBottom: '18px', fontSize: '1.2rem' } }, 
                                                                    `${index + 1}. ${pergunta}`
                                                                ),
                                                                h('div', { style: { display: 'flex', gap: '18px', flexWrap: 'wrap', marginBottom: '18px' } },
                                                                    ['excelente', 'bom', 'regular', 'ruim', 'nao_verificado'].map(opcao => {
                                                                        const labels = { 
                                                                            excelente: 'üèÜ Excelente', 
                                                                            bom: '‚úÖ Bom', 
                                                                            regular: '‚ö†Ô∏è Regular', 
                                                                            ruim: '‚ùå Ruim',
                                                                            nao_verificado: '‚ùì N√£o Verificado'
                                                                        };
                                                                        return h('label', { 
                                                                            key: opcao,
                                                                            style: { 
                                                                                display: 'flex', 
                                                                                alignItems: 'center',
                                                                                gap: '12px',
                                                                                cursor: 'pointer',
                                                                                fontSize: '1rem',
                                                                                padding: '14px 20px',
                                                                                borderRadius: '12px',
                                                                                background: auditoriaFormState[`staff_geral_${index}`] === opcao ? 'rgba(255, 255, 255, 0.35)' : 'rgba(255, 255, 255, 0.15)',
                                                                                border: '3px solid ' + (auditoriaFormState[`staff_geral_${index}`] === opcao ? 'white' : 'rgba(255, 255, 255, 0.4)'),
                                                                                fontWeight: '600'
                                                                            }
                                                                        },
                                                                            h('input', {
                                                                                type: 'radio',
                                                                                name: `staff_geral_${index}`,
                                                                                value: opcao,
                                                                                checked: auditoriaFormState[`staff_geral_${index}`] === opcao,
                                                                                onChange: (e) => setAuditoriaFormState({...auditoriaFormState, [`staff_geral_${index}`]: e.target.value}),
                                                                                style: { margin: 0, transform: 'scale(1.4)' }
                                                                            }),
                                                                            h('span', { style: { color: 'white', fontWeight: '700' } }, labels[opcao])
                                                                        );
                                                                    })
                                                                ),
                                                                h('textarea', {
                                                                    value: auditoriaFormState[`obs_staff_geral_${index}`] || '',
                                                                    onChange: (e) => setAuditoriaFormState({...auditoriaFormState, [`obs_staff_geral_${index}`]: e.target.value}),
                                                                    style: {
                                                                        width: '100%',
                                                                        padding: '16px',
                                                                        border: '3px solid rgba(255, 255, 255, 0.4)',
                                                                        borderRadius: '12px',
                                                                        fontSize: '1rem',
                                                                        background: 'rgba(255, 255, 255, 0.2)',
                                                                        color: 'white',
                                                                        fontFamily: 'inherit',
                                                                        resize: 'vertical',
                                                                        minHeight: '100px'
                                                                    },
                                                                    placeholder: `Observa√ß√µes sobre: ${pergunta}...`
                                                                })
                                                            )
                                                        )
                                                    )
                                                ),

                                                // Se√ß√£o 3: Perguntas espec√≠ficas baseadas no setor
                                                currentAuditoriaState.tipo === 'roleplay' && (() => {
                                                    const setorSelecionado = auditoriaFormState.setor;
                                                    let perguntasEspecificas = [];
                                                    let tituloSecao = '';
                                                    let corSecao = '#10b981';

                                                    if (setorSelecionado === 'Hospital') {
                                                        tituloSecao = 'üè• AUDITORIA RP HOSPITAL - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#dc2626';
                                                        perguntasEspecificas = [
                                                            // Bate-ponto e Atividade
                                                            { q: 'üïê O bate-ponto est√° funcional para todos os cargos do hospital?', key: 'batePontoFuncionalHospital' },
                                                            { q: '‚è∞ A equipe est√° batendo ponto corretamente nas entradas e sa√≠das?', key: 'batePontoCorretoHospital' },
                                                            { q: 'üë®‚Äç‚öïÔ∏è H√° presen√ßa regular de m√©dicos e enfermeiros nos hor√°rios de pico?', key: 'presencaRegularEquipe' },
                                                            { q: 'üåô Existe plant√£o ativo no momento da auditoria?', key: 'plantaoAtivo' },
                                                            
                                                            // Equipe e Fun√ß√µes
                                                            { q: 'ü©∫ M√©dicos est√£o realizando atendimentos via /me e /do corretamente?', key: 'atendimentosMedicosCorretos' },
                                                            { q: 'üë©‚Äç‚öïÔ∏è Enfermeiros est√£o cumprindo suas fun√ß√µes de apoio nos atendimentos?', key: 'funcaoEnfermeiros' },
                                                            { q: 'üëî Existe coordena√ß√£o de cargos (diretor, chefe, equipe t√©cnica)?', key: 'coordenacaoCargos' },
                                                            
                                                            // Painel e Sistema
                                                            { q: 'üíª O painel do hospital est√° funcionando normalmente?', key: 'painelHospitalFuncional' },
                                                            { q: 'üìã Est√£o sendo registradas as testadas m√©dicas no painel?', key: 'testadasMedicasRegistradas' },
                                                            { q: 'üî¨ Os exames e diagn√≥sticos est√£o sendo feitos com base em situa√ß√µes de RP?', key: 'examesBaseadosRP' },
                                                            { q: 'üè• As cirurgias e interna√ß√µes est√£o seguindo coer√™ncia e l√≥gica?', key: 'cirurgiasCoerentes' },
                                                            
                                                            // Atendimento RP
                                                            { q: '‚è≥ Os atendimentos est√£o respeitando tempo de espera e fila?', key: 'respeitoFilaAtendimento' },
                                                            { q: 'üö´ Est√° havendo abuso de prioridade (ex: "me atende primeiro porque sou staff")?', key: 'abusoPrioridadeAtendimento' },
                                                            { q: 'üé≠ O hospital est√° atendendo com base em sintomas e hist√≥rias do RP (e n√£o s√≥ comandos)?', key: 'atendimentoBaseadoRP' },
                                                            { q: 'ü©∏ Est√£o sendo feitos atendimentos de ferimentos por tiro, acidente, queda etc. com bom detalhamento?', key: 'atendimentosFerimentosDetalhados' },
                                                            
                                                            // Ocorr√™ncias e Situa√ß√µes Especiais
                                                            { q: 'üö® O hospital atendeu emerg√™ncias envolvendo pol√≠cia ou bombeiros nas √∫ltimas 48h?', key: 'emergenciasUltimas48h' },
                                                            { q: '‚ùå Existem registros de recusas de atendimento sem justificativa RP?', key: 'recusasAtendimentoSemJustificativa' },
                                                            { q: 'üèÉ H√° presen√ßa de membros do hospital em cenas importantes da cidade (acidente, inc√™ndio, tiroteio)?', key: 'presencaCenasImportantes' },
                                                            { q: 'üöë A ambul√¢ncia foi utilizada para resgate de forma correta nos √∫ltimos dias?', key: 'ambulanciaUtilizadaCorretamente' },
                                                            
                                                            // Observa√ß√µes Extras
                                                            { q: 'üë®‚Äçüíº Alguma mudan√ßa de lideran√ßa ocorreu recentemente?', key: 'mudancaLiderancaRecente' },
                                                            { q: 'üîÑ Houve atualiza√ß√£o no painel, sistema ou estrutura do hospital?', key: 'atualizacaoSistemaHospital' },
                                                            { q: 'üí° Existe sugest√£o de melhoria feita pela pr√≥pria equipe?', key: 'sugestaoMelhoriaEquipe' }
                                                        ];
                                                    } else if (setorSelecionado === 'Jur√≠dico') {
                                                        tituloSecao = '‚öñÔ∏è AUDITORIA RP JUR√çDICO - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#1f2937';
                                                        perguntasEspecificas = [
                                                            { q: 'üë®‚Äçüíº Os advogados est√£o cumprindo hor√°rios e disponibilidade para clientes?', key: 'advogadosHorarios' },
                                                            { q: 'üìã Os casos e processos est√£o sendo registrados adequadamente?', key: 'casosRegistrados' },
                                                            { q: '‚öñÔ∏è As defesas em tribunal est√£o sendo feitas com qualidade RP?', key: 'defesasQualidade' },
                                                            { q: 'üíº O escrit√≥rio est√° organizado e funcional para atendimentos?', key: 'escritorioFuncional' },
                                                            { q: 'üìû A comunica√ß√£o com delegados e ju√≠zes est√° adequada?', key: 'comunicacaoJudiciario' },
                                                            { q: 'üí∞ Os honor√°rios est√£o sendo cobrados conforme tabela da cidade?', key: 'honorariosCorretos' }
                                                        ];
                                                    } else if (setorSelecionado === 'Prefeitura') {
                                                        tituloSecao = 'üèõÔ∏è AUDITORIA RP PREFEITURA - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#059669';
                                                        perguntasEspecificas = [
                                                            { q: 'üè¢ O gabinete do prefeito est√° funcionando regularmente?', key: 'gabinetePrefeito' },
                                                            { q: 'üìã Os servi√ßos p√∫blicos (alvar√°, licen√ßas) est√£o sendo prestados?', key: 'servicosPublicos' },
                                                            { q: 'üí∞ A arrecada√ß√£o de impostos est√° sendo feita corretamente?', key: 'arrecadacaoImpostos' },
                                                            { q: 'üèóÔ∏è Projetos de obras p√∫blicas est√£o sendo executados?', key: 'obrasPublicas' },
                                                            { q: 'üë• A equipe de funcion√°rios p√∫blicos est√° ativa?', key: 'funcionariosAtivos' },
                                                            { q: 'üì∞ A comunica√ß√£o com a popula√ß√£o est√° sendo mantida?', key: 'comunicacaoPopulacao' }
                                                        ];
                                                    } else if (setorSelecionado === 'Igreja') {
                                                        tituloSecao = '‚õ™ AUDITORIA RP IGREJA - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#7c3aed';
                                                        perguntasEspecificas = [
                                                            { q: '‚õ™ O templo est√° funcionando regularmente para cultos e cerim√¥nias?', key: 'temploFuncionando' },
                                                            { q: 'üë®‚Äçüíº H√° presen√ßa regular do pastor ou l√≠der religioso?', key: 'presencaLider' },
                                                            { q: 'üíí Casamentos e batizados est√£o sendo realizados conforme o RP?', key: 'cerimoniasRealizadas' },
                                                            { q: 'üí∞ As ofertas e d√≠zimos est√£o sendo registrados adequadamente?', key: 'ofertasRegistradas' },
                                                            { q: 'ü§ù A igreja est√° participando de eventos comunit√°rios da cidade?', key: 'participacaoComunitaria' },
                                                            { q: 'üìñ Os serm√µes e atividades religiosas t√™m qualidade de RP?', key: 'qualidadeRP' }
                                                        ];
                                                    } else if (setorSelecionado === 'Jornal') {
                                                        tituloSecao = 'üì∞ AUDITORIA RP JORNAL - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#0891b2';
                                                        perguntasEspecificas = [
                                                            { q: 'üì∞ O jornal est√° publicando not√≠cias regularmente?', key: 'publicacoesRegulares' },
                                                            { q: 'üìù Os jornalistas est√£o cobrindo eventos importantes da cidade?', key: 'coberturaEventos' },
                                                            { q: 'üé§ Entrevistas e reportagens s√£o feitas com qualidade RP?', key: 'qualidadeReportagens' },
                                                            { q: 'üì∏ H√° registro fotogr√°fico dos acontecimentos?', key: 'registroFotografico' },
                                                            { q: 'üíª O site ou sistema de not√≠cias est√° atualizado?', key: 'sistemaAtualizado' },
                                                            { q: 'üóûÔ∏è As not√≠cias respeitam a veracidade e √©tica jornal√≠stica?', key: 'eticaJornalistica' }
                                                        ];
                                                    } else if (setorSelecionado === 'Mec√¢nica') {
                                                        tituloSecao = 'üîß AUDITORIA RP MEC√ÇNICA - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#ea580c';
                                                        perguntasEspecificas = [
                                                            { q: 'üîß A oficina est√° funcionando e atendendo clientes regularmente?', key: 'oficinaFuncionando' },
                                                            { q: 'üöó Os reparos de ve√≠culos s√£o feitos com qualidade RP?', key: 'reparosQualidade' },
                                                            { q: 'üí∞ Os pre√ßos dos servi√ßos est√£o dentro da tabela da cidade?', key: 'precosTabela' },
                                                            { q: '‚öôÔ∏è H√° variedade de servi√ßos oferecidos (motor, pneu, tunning)?', key: 'variedadeServicos' },
                                                            { q: 'üë®‚Äçüîß Os mec√¢nicos demonstram conhecimento t√©cnico no RP?', key: 'conhecimentoTecnico' },
                                                            { q: 'üïê Os hor√°rios de funcionamento s√£o respeitados?', key: 'horariosFuncionamento' }
                                                        ];
                                                    } else if (setorSelecionado === 'Empres√°rios') {
                                                        tituloSecao = 'üíº AUDITORIA RP EMPRES√ÅRIOS - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#059669';
                                                        perguntasEspecificas = [
                                                            { q: 'üè¢ As empresas est√£o operando e gerando movimenta√ß√£o econ√¥mica?', key: 'empresasOperando' },
                                                            { q: 'üí∞ As transa√ß√µes comerciais s√£o registradas adequadamente?', key: 'transacoesRegistradas' },
                                                            { q: 'üë• H√° contrata√ß√£o de funcion√°rios e gera√ß√£o de empregos?', key: 'geracaoEmpregos' },
                                                            { q: 'üìã Os alvar√°s e licen√ßas empresariais est√£o em dia?', key: 'licencasEmDia' },
                                                            { q: 'ü§ù Existe coopera√ß√£o e parcerias entre empres√°rios?', key: 'cooperacaoEmpresas' },
                                                            { q: 'üìà As empresas contribuem para o crescimento econ√¥mico da cidade?', key: 'contribuicaoEconomica' }
                                                        ];
                                                    } else if (setorSelecionado === 'Fac√ß√£o') {
                                                        tituloSecao = 'üî´ AUDITORIA RP FAC√á√ÉO - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#dc2626';
                                                        perguntasEspecificas = [
                                                            { q: 'üè† O territ√≥rio da fac√ß√£o est√° bem estabelecido e defendido?', key: 'territorioEstabelecido' },
                                                            { q: 'üë• A hierarquia interna est√° funcionando adequadamente?', key: 'hierarquiaFuncionando' },
                                                            { q: 'üí∞ As atividades il√≠citas geram renda para a organiza√ß√£o?', key: 'atividadesGeram' },
                                                            { q: 'üî´ Os conflitos com outras fac√ß√µes seguem as regras de RP?', key: 'conflitosSegueRP' },
                                                            { q: 'üöî As intera√ß√µes com a pol√≠cia s√£o realistas?', key: 'interacaoPolicia' },
                                                            { q: '‚öñÔ∏è A fac√ß√£o respeita as regras gerais da cidade?', key: 'respeitaRegras' }
                                                        ];
                                                    } else if (setorSelecionado === 'M√°fia') {
                                                        tituloSecao = 'üé© AUDITORIA RP M√ÅFIA - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#374151';
                                                        perguntasEspecificas = [
                                                            { q: 'üé© A estrutura familiar/organizacional est√° bem definida?', key: 'estruturaFamiliar' },
                                                            { q: 'ü§µ Os rituais e tradi√ß√µes da m√°fia s√£o seguidos no RP?', key: 'rituaisTradicoes' },
                                                            { q: 'üíº As atividades de "neg√≥cios" s√£o conduzidas com discri√ß√£o?', key: 'atividadesDiscricao' },
                                                            { q: 'ü§ù H√° respeito e c√≥digo de honra entre os membros?', key: 'codigoHonra' },
                                                            { q: 'üí∞ A lavagem de dinheiro e neg√≥cios legais s√£o bem executados?', key: 'lavagemDinheiro' },
                                                            { q: 'üï¥Ô∏è A m√°fia mant√©m influ√™ncia pol√≠tica e social na cidade?', key: 'influenciaSocial' }
                                                        ];
                                                    } else if (setorSelecionado === 'Jur√≠dico') {
                                                        tituloSecao = '‚öñÔ∏è AUDITORIA RP JUR√çDICO - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#1f2937';
                                                        perguntasEspecificas = [
                                                            { q: 'üë®‚Äçüíº Os advogados est√£o cumprindo hor√°rios e disponibilidade para clientes?', key: 'advogadosHorarios' },
                                                            { q: 'üìã Os casos e processos est√£o sendo registrados adequadamente?', key: 'casosRegistrados' },
                                                            { q: '‚öñÔ∏è As defesas em tribunal est√£o sendo feitas com qualidade RP?', key: 'defesasQualidade' },
                                                            { q: 'üíº O escrit√≥rio est√° organizado e funcional para atendimentos?', key: 'escritorioFuncional' },
                                                            { q: 'üìû A comunica√ß√£o com delegados e ju√≠zes est√° adequada?', key: 'comunicacaoJudiciario' },
                                                            { q: 'üí∞ Os honor√°rios est√£o sendo cobrados conforme tabela da cidade?', key: 'honorariosCorretos' }
                                                        ];
                                                    } else if (setorSelecionado === 'Prefeitura') {
                                                        tituloSecao = 'üèõÔ∏è AUDITORIA RP PREFEITURA - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#059669';
                                                        perguntasEspecificas = [
                                                            { q: 'üè¢ O gabinete do prefeito est√° funcionando regularmente?', key: 'gabinetePrefeito' },
                                                            { q: 'üìã Os servi√ßos p√∫blicos (alvar√°, licen√ßas) est√£o sendo prestados?', key: 'servicosPublicos' },
                                                            { q: 'üí∞ A arrecada√ß√£o de impostos est√° sendo feita corretamente?', key: 'arrecadacaoImpostos' },
                                                            { q: 'üèóÔ∏è Projetos de obras p√∫blicas est√£o sendo executados?', key: 'obrasPublicas' },
                                                            { q: 'üë• A equipe de funcion√°rios p√∫blicos est√° ativa?', key: 'funcionariosAtivos' },
                                                            { q: 'üì∞ A comunica√ß√£o com a popula√ß√£o est√° sendo mantida?', key: 'comunicacaoPopulacao' }
                                                        ];
                                                    } else if (setorSelecionado === 'Pol√≠cia') {
                                                        tituloSecao = 'üöî AUDITORIA RP POL√çCIA - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#dc2626';
                                                        perguntasEspecificas = [
                                                            { q: 'Estrutura f√≠sica da pol√≠cia est√° funcional?', key: 'estruturaFisicaPolicia' },
                                                            { q: 'Equipe policial ativa e presente nas fun√ß√µes RP?', key: 'equipePolicialAtiva' },
                                                            { q: 'Porte de arma cumprido corretamente pelos agentes?', key: 'porteArmaCorreto' },
                                                            { q: 'Mandados de pris√£o sendo executados conforme regras RP?', key: 'mandadosPrisaoCorretos' },
                                                            { q: 'Pris√µes feitas de forma adequada e respeitando o RP?', key: 'prisoesAdequadas' },
                                                            { q: 'Multas e advert√™ncias aplicadas corretamente?', key: 'multasAdvertenciasCorretas' },
                                                            { q: 'Comunica√ß√£o interna da equipe est√° fluindo bem?', key: 'comunicacaoInternaPolicia' },
                                                            { q: 'Registros e relat√≥rios policiais atualizados?', key: 'registrosRelatoriosAtualizados' },
                                                            { q: 'Cumprimento dos hor√°rios e turnos?', key: 'cumprimentoHorarios' },
                                                            { q: 'Houve reclama√ß√µes ou problemas de conduta?', key: 'reclamacoesProblemasconduta' }
                                                        ];
                                                    } else if (setorSelecionado === 'Bombeiros') {
                                                        tituloSecao = 'üöí AUDITORIA RP BOMBEIROS - PERGUNTAS ESPEC√çFICAS';
                                                        corSecao = '#f97316';
                                                        perguntasEspecificas = [
                                                            { q: 'A equipe registrou corretamente o bate-ponto nos hor√°rios estabelecidos?', key: 'batePontoCorreto' },
                                                            { q: 'Houve atrasos ou faltas n√£o justificadas no per√≠odo auditado?', key: 'atrasosNaoJustificados' },
                                                            { q: 'A estrutura f√≠sica (bombeiros, ve√≠culos, equipamentos) est√° funcional?', key: 'estruturaFisicaBombeiros' },
                                                            { q: 'Os atendimentos e resgates em RP foram realizados de forma adequada?', key: 'atendimentosResgatesAdequados' },
                                                            { q: 'A equipe utiliza corretamente os equipamentos e ve√≠culos durante o RP?', key: 'usoCorretoEquipamentos' }
                                                        ];
                                                    }

                                                    if (perguntasEspecificas.length > 0) {
                                                        return h('div', { style: { padding: '32px', background: `linear-gradient(135deg, ${corSecao}55, ${corSecao}44)`, borderRadius: '24px', border: `4px solid ${corSecao}` } },
                                                            h('h4', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '28px', color: corSecao } }, tituloSecao),
                                                            h('div', { style: { display: 'grid', gap: '28px' } },
                                                                perguntasEspecificas.map((item, index) => 
                                                                    h('div', { key: `especifica_${index}`, style: { padding: '24px', background: 'rgba(255, 255, 255, 0.2)', borderRadius: '16px' } },
                                                                        h('label', { style: { display: 'block', color: 'white', fontWeight: '700', marginBottom: '18px', fontSize: '1.3rem' } }, 
                                                                            `${index + 1}. ${item.q}`
                                                                        ),
                                                                        h('div', { style: { display: 'flex', gap: '18px', flexWrap: 'wrap', marginBottom: '18px' } },
                                                                            ['excelente', 'bom', 'regular', 'ruim', 'nao_verificado'].map(opcao => {
                                                                                const labels = { 
                                                                                    excelente: 'üèÜ Excelente', 
                                                                                    bom: '‚úÖ Bom', 
                                                                                    regular: '‚ö†Ô∏è Regular', 
                                                                                    ruim: '‚ùå Ruim',
                                                                                    nao_verificado: '‚ùì N√£o Verificado'
                                                                                };
                                                                                return h('label', { 
                                                                                    key: opcao,
                                                                                    style: { 
                                                                                        display: 'flex', 
                                                                                        alignItems: 'center',
                                                                                        gap: '12px',
                                                                                        cursor: 'pointer',
                                                                                        fontSize: '1rem',
                                                                                        padding: '14px 20px',
                                                                                        borderRadius: '12px',
                                                                                        background: auditoriaFormState[`especifica_${item.key}`] === opcao ? 'rgba(255, 255, 255, 0.35)' : 'rgba(255, 255, 255, 0.15)',
                                                                                        border: '3px solid ' + (auditoriaFormState[`especifica_${item.key}`] === opcao ? 'white' : 'rgba(255, 255, 255, 0.4)'),
                                                                                        fontWeight: '600'
                                                                                    }
                                                                                },
                                                                                    h('input', {
                                                                                        type: 'radio',
                                                                                        name: `especifica_${item.key}`,
                                                                                        value: opcao,
                                                                                        checked: auditoriaFormState[`especifica_${item.key}`] === opcao,
                                                                                        onChange: (e) => setAuditoriaFormState({...auditoriaFormState, [`especifica_${item.key}`]: e.target.value}),
                                                                                        style: { margin: 0, transform: 'scale(1.4)' }
                                                                                    }),
                                                                                    h('span', { style: { color: 'white', fontWeight: '700' } }, labels[opcao])
                                                                                );
                                                                            })
                                                                        ),
                                                                        h('textarea', {
                                                                            value: auditoriaFormState[`obs_${item.key}`] || '',
                                                                            onChange: (e) => setAuditoriaFormState({...auditoriaFormState, [`obs_${item.key}`]: e.target.value}),
                                                                            style: {
                                                                                width: '100%',
                                                                                padding: '16px',
                                                                                border: '3px solid rgba(255, 255, 255, 0.4)',
                                                                                borderRadius: '12px',
                                                                                fontSize: '1rem',
                                                                                background: 'rgba(255, 255, 255, 0.2)',
                                                                                color: 'white',
                                                                                fontFamily: 'inherit',
                                                                                resize: 'vertical',
                                                                                minHeight: '100px'
                                                                            },
                                                                            placeholder: 'Observa√ß√µes espec√≠ficas sobre este aspecto...'
                                                                        })
                                                                    )
                                                                )
                                                            )
                                                        );
                                                    } else {
                                                        return h('div', { style: { padding: '28px', background: 'rgba(156, 163, 175, 0.2)', borderRadius: '20px', textAlign: 'center' } },
                                                            h('p', { style: { color: 'rgba(255, 255, 255, 0.8)', fontSize: '1.2rem', fontWeight: '600' } }, 
                                                                `üì∞ Selecione "Hospital", "Pol√≠cia" ou "Bombeiros" para ver perguntas espec√≠ficas`
                                                            )
                                                        );
                                                    }
                                                })(),

                                                // Se√ß√£o 3: Economia e Gest√£o Financeira - OBRIGAT√ìRIO PARA TODAS AS AUDITORIAS RP
                                                currentAuditoriaState.tipo === 'roleplay' && h('div', { style: { background: 'linear-gradient(135deg, #f59e0b, #d97706)', padding: '40px', borderRadius: '20px', color: 'white' } },
                                                    h('h3', { style: { fontSize: '2rem', fontWeight: 'bold', marginBottom: '20px' } }, 'üí∞ ECONOMIA E GEST√ÉO FINANCEIRA'),
                                                    h('p', { style: { fontSize: '1.1rem', marginBottom: '28px', opacity: 0.9 } }, 
                                                        'üíº Se√ß√£o obrigat√≥ria para registrar dados financeiros da organiza√ß√£o'
                                                    ),
                                                    h('div', { style: { display: 'grid', gap: '32px' } },
                                                        // Pergunta 1
                                                        h('div', { style: { padding: '24px', background: 'rgba(255, 255, 255, 0.2)', borderRadius: '16px' } },
                                                            h('label', { style: { display: 'block', color: 'white', fontWeight: '700', marginBottom: '18px', fontSize: '1.3rem' } }, 
                                                                '1. üíª O painel econ√¥mico est√° sendo utilizado corretamente pelos respons√°veis da organiza√ß√£o?'
                                                            ),
                                                            h('div', { style: { display: 'flex', gap: '18px', flexWrap: 'wrap', marginBottom: '18px' } },
                                                                ['excelente', 'bom', 'regular', 'ruim', 'nao_verificado'].map(opcao => {
                                                                    const labels = { 
                                                                        excelente: 'üèÜ Excelente', 
                                                                        bom: '‚úÖ Bom', 
                                                                        regular: '‚ö†Ô∏è Regular', 
                                                                        ruim: '‚ùå Ruim',
                                                                        nao_verificado: '‚ùì N√£o Verificado'
                                                                    };
                                                                    return h('label', { 
                                                                        key: opcao,
                                                                        style: { 
                                                                            display: 'flex', 
                                                                            alignItems: 'center',
                                                                            gap: '12px',
                                                                            cursor: 'pointer',
                                                                            fontSize: '1rem',
                                                                            padding: '14px 20px',
                                                                            borderRadius: '12px',
                                                                            background: auditoriaFormState.economia_painel_utilizado === opcao ? 'rgba(255, 255, 255, 0.35)' : 'rgba(255, 255, 255, 0.15)',
                                                                            border: '3px solid ' + (auditoriaFormState.economia_painel_utilizado === opcao ? 'white' : 'rgba(255, 255, 255, 0.4)'),
                                                                            fontWeight: '600'
                                                                        }
                                                                    },
                                                                        h('input', {
                                                                            type: 'radio',
                                                                            name: 'economia_painel_utilizado',
                                                                            value: opcao,
                                                                            checked: auditoriaFormState.economia_painel_utilizado === opcao,
                                                                            onChange: (e) => setAuditoriaFormState({...auditoriaFormState, economia_painel_utilizado: e.target.value}),
                                                                            style: { margin: 0, transform: 'scale(1.4)' }
                                                                        }),
                                                                        h('span', { style: { color: 'white', fontWeight: '700' } }, labels[opcao])
                                                                    );
                                                                })
                                                            ),
                                                            h('textarea', {
                                                                value: auditoriaFormState.obs_economia_painel || '',
                                                                onChange: (e) => setAuditoriaFormState({...auditoriaFormState, obs_economia_painel: e.target.value}),
                                                                style: {
                                                                    width: '100%',
                                                                    padding: '16px',
                                                                    border: '3px solid rgba(255, 255, 255, 0.4)',
                                                                    borderRadius: '12px',
                                                                    fontSize: '1rem',
                                                                    background: 'rgba(255, 255, 255, 0.2)',
                                                                    color: 'white',
                                                                    fontFamily: 'inherit',
                                                                    resize: 'vertical',
                                                                    minHeight: '100px'
                                                                },
                                                                placeholder: 'Ex: registros organizados, entradas e sa√≠das justificadas...'
                                                            })
                                                        ),

                                                        // Campo para registrar saldo atual
                                                        h('div', { style: { padding: '32px', background: 'rgba(255, 255, 255, 0.3)', borderRadius: '20px', border: '4px solid white' } },
                                                            h('h4', { style: { fontSize: '1.6rem', fontWeight: 'bold', color: 'white', marginBottom: '20px' } }, 'üí∏ REGISTRO DO SALDO ATUAL'),
                                                            h('div', { style: { display: 'grid', gridTemplateColumns: '2fr 3fr', gap: '24px' } },
                                                                h('div', null,
                                                                    h('label', { style: { display: 'block', color: 'white', fontWeight: '700', marginBottom: '12px', fontSize: '1.2rem' } }, 
                                                                        'üí∞ Saldo em Caixa (R$)'
                                                                    ),
                                                                    h('input', {
                                                                        type: 'text',
                                                                        value: auditoriaFormState.economia_saldo_atual || '',
                                                                        onChange: (e) => setAuditoriaFormState({...auditoriaFormState, economia_saldo_atual: e.target.value}),
                                                                        style: {
                                                                            width: '100%',
                                                                            padding: '16px',
                                                                            border: '3px solid white',
                                                                            borderRadius: '12px',
                                                                            fontSize: '1.2rem',
                                                                            background: 'white',
                                                                            color: '#1f2937',
                                                                            fontWeight: '600',
                                                                            textAlign: 'center'
                                                                        },
                                                                        placeholder: 'Ex: R$ 125.000'
                                                                    })
                                                                ),
                                                                h('div', null,
                                                                    h('label', { style: { display: 'block', color: 'white', fontWeight: '700', marginBottom: '12px', fontSize: '1.2rem' } }, 
                                                                        'üìã Observa√ß√µes sobre o Dinheiro'
                                                                    ),
                                                                    h('textarea', {
                                                                        value: auditoriaFormState.obs_economia_saldo_detalhes || '',
                                                                        onChange: (e) => setAuditoriaFormState({...auditoriaFormState, obs_economia_saldo_detalhes: e.target.value}),
                                                                        style: {
                                                                            width: '100%',
                                                                            padding: '16px',
                                                                            border: '3px solid white',
                                                                            borderRadius: '12px',
                                                                            fontSize: '1rem',
                                                                            background: 'white',
                                                                            color: '#1f2937',
                                                                            fontFamily: 'inherit',
                                                                            resize: 'vertical',
                                                                            minHeight: '100px'
                                                                        },
                                                                        placeholder: 'Ex: dinheiro guardado em cofre, investimentos, d√≠vidas pendentes, gastos planejados...'
                                                                    })
                                                                )
                                                            )
                                                        )
                                                    )
                                                ),

                                                // Se√ß√£o 4: Relat√≥rio final
                                                h('div', { style: { background: 'linear-gradient(135deg, #dc2626, #b91c1c)', padding: '40px', borderRadius: '20px', color: 'white' } },
                                                    h('h3', { style: { fontSize: '2rem', fontWeight: 'bold', marginBottom: '20px' } }, 'üìù RELAT√ìRIO FINAL'),
                                                    h('p', { style: { fontSize: '1.1rem', marginBottom: '20px', opacity: 0.9 } }, 
                                                        '‚ö†Ô∏è M√≠nimo 100 caracteres para uma auditoria completa'
                                                    ),
                                                    h('textarea', {
                                                        value: auditoriaFormState.relatorioFinal || '',
                                                        onChange: (e) => setAuditoriaFormState({...auditoriaFormState, relatorioFinal: e.target.value}),
                                                        style: {
                                                            width: '100%',
                                                            padding: '24px',
                                                            border: '4px solid white',
                                                            borderRadius: '16px',
                                                            fontSize: '1.1rem',
                                                            resize: 'vertical',
                                                            minHeight: '300px',
                                                            background: 'white',
                                                            color: '#1f2937',
                                                            fontFamily: 'inherit',
                                                            lineHeight: '1.6'
                                                        },
                                                        placeholder: `üìù RELAT√ìRIO COMPLETO DA AUDITORIA\n\n‚Ä¢ Resumo dos principais achados\n‚Ä¢ Pontos fortes identificados\n‚Ä¢ Problemas encontrados\n‚Ä¢ Recomenda√ß√µes espec√≠ficas\n‚Ä¢ Conclus√£o da auditoria\n\nAuditor: ${currentUser.nome}\nSetor: ${auditoriaFormState.setor || 'A definir'}\nTurno: ${auditoriaFormState.turno || 'A definir'}`
                                                    }),
                                                    h('div', { style: { marginTop: '20px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' } },
                                                        h('span', { 
                                                            style: { 
                                                                fontSize: '1.1rem', 
                                                                fontWeight: '700',
                                                                color: (auditoriaFormState.relatorioFinal?.length >= 100) ? '#10b981' : '#fbbf24'
                                                            } 
                                                        }, 
                                                            `üìä ${auditoriaFormState.relatorioFinal?.length || 0} / 100 caracteres`
                                                        ),
                                                        h('span', { 
                                                            style: { 
                                                                fontSize: '1.2rem', 
                                                                fontWeight: 'bold',
                                                                color: (auditoriaFormState.relatorioFinal?.length >= 100) ? '#10b981' : '#fbbf24'
                                                            } 
                                                        }, 
                                                            (auditoriaFormState.relatorioFinal?.length >= 100) ? '‚úÖ RELAT√ìRIO OK' : '‚è≥ M√çNIMO N√ÉO ATINGIDO'
                                                        )
                                                    )
                                                ),

                                                // Bot√£o finalizar
                                                h('div', { style: { display: 'flex', justifyContent: 'center', gap: '24px', padding: '32px' } },
                                                    h('button', {
                                                        onClick: saveAuditoriaData,
                                                        style: {
                                                            background: '#16a34a',
                                                            color: 'white',
                                                            padding: '18px 40px',
                                                            border: 'none',
                                                            borderRadius: '12px',
                                                            cursor: 'pointer',
                                                            fontWeight: '700',
                                                            fontSize: '1.2rem'
                                                        }
                                                    }, 'üèÜ FINALIZAR AUDITORIA')
                                                )
                                            )
                                        )
                                    )
                                )
                            );
                        }

                        return h('div', { style: { minHeight: '100vh', background: '#f8fafc' } },
                            h(Header),
                            h('div', { style: { display: 'flex' } },
                                h(Sidebar),
                                h('main', { style: { flex: 1, padding: '40px' } },
                                    h('h2', { style: { fontSize: '2.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '32px' } }, 'üîç Auditoria'),
                                    
                                    // Cards para criar novas auditorias
                                    h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '24px', marginBottom: '40px' } },
                                        h('div', {
                                            onClick: () => startNewAuditoria('staff'),
                                            style: {
                                                background: 'linear-gradient(135deg, #8b5cf6, #7c3aed)',
                                                color: 'white',
                                                padding: '32px',
                                                borderRadius: '16px',
                                                cursor: 'pointer',
                                                textAlign: 'center'
                                            }
                                        },
                                            h('div', { style: { fontSize: '4rem', marginBottom: '16px' } }, 'üë•'),
                                            h('h3', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '8px' } }, 'Auditoria Staff'),
                                            h('p', { style: { opacity: 0.9, fontSize: '1.1rem' } }, 'Auditoria das equipes Discord - 100 pontos')
                                        ),
                                        h('div', {
                                            onClick: () => startNewAuditoria('roleplay'),
                                            style: {
                                                background: 'linear-gradient(135deg, #06b6d4, #0891b2)',
                                                color: 'white',
                                                padding: '32px',
                                                borderRadius: '16px',
                                                cursor: 'pointer',
                                                textAlign: 'center'
                                            }
                                        },
                                            h('div', { style: { fontSize: '4rem', marginBottom: '16px' } }, 'üé≠'),
                                            h('h3', { style: { fontSize: '1.8rem', fontWeight: 'bold', marginBottom: '8px' } }, 'Auditoria Roleplay'),
                                            h('p', { style: { opacity: 0.9, fontSize: '1.1rem' } }, 'Auditoria dos setores RP - 100 pontos')
                                        )
                                    ),

                                    // Lista de auditorias existentes
                                    h('div', { style: { background: 'white', borderRadius: '16px', padding: '32px', boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)' } },
                                        h('h3', { style: { fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '24px' } }, 'Minhas Auditorias'),
                                        h('div', { style: { display: 'grid', gap: '16px' } },
                                            auditorias
                                                .filter(a => a.autorId === currentUser.id)
                                                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                                                .slice(0, 10)
                                                .map(auditoria => 
                                                    h('div', {
                                                        key: auditoria.id,
                                                        style: {
                                                            display: 'flex',
                                                            justifyContent: 'space-between',
                                                            alignItems: 'center',
                                                            padding: '28px',
                                                            border: '2px solid #e5e7eb',
                                                            borderRadius: '16px',
                                                            background: '#fafafa',
                                                            borderLeft: `6px solid ${auditoria.status === 'aprovada' ? '#16a34a' : auditoria.status === 'aguardando_aprovacao' ? '#f59e0b' : '#8b5cf6'}`
                                                        }
                                                    },
                                                        h('div', { style: { flex: 1 } },
                                                            h('p', { style: { fontWeight: '700', color: '#1f2937', fontSize: '1.3rem', margin: '0 0 12px 0' } },
                                                                `AUDITORIA ${auditoria.tipo === 'staff' ? 'STAFF' : 'ROLEPLAY'}`
                                                            ),
                                                            h('p', { style: { color: '#1f2937', fontSize: '1rem', margin: '0 0 8px 0', fontWeight: '600' } },
                                                                `üèõÔ∏è Setor: ${auditoria.setor || 'N√£o especificado'}`
                                                            ),
                                                            h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(220px, 1fr))', gap: '8px' } },
                                                                auditoria.turno && h('p', { style: { color: '#6b7280', fontSize: '0.95rem', margin: 0 } },
                                                                    `üïê Turno: ${auditoria.turno}`
                                                                ),
                                                                h('p', { style: { color: '#6b7280', fontSize: '0.9rem', margin: 0 } },
                                                                    `üìÖ Criado: ${new Date(auditoria.createdAt).toLocaleDateString('pt-BR')}`
                                                                ),
                                                                auditoria.subsetor && h('p', { style: { color: '#6b7280', fontSize: '0.9rem', margin: 0 } },
                                                                    `üöî Subsetor: ${auditoria.subsetor}`
                                                                ),
                                                                auditoria.duracaoAutomatica && h('p', { style: { color: '#059669', fontSize: '0.95rem', margin: 0, fontWeight: '600' } },
                                                                    `‚è±Ô∏è Dura√ß√£o: ${auditoria.duracaoAutomatica}`
                                                                )
                                                            )
                                                        ),
                                                        h('div', { style: { display: 'flex', alignItems: 'center', gap: '16px' } },
                                                            h('span', {
                                                                style: {
                                                                    padding: '12px 24px',
                                                                    borderRadius: '25px',
                                                                    fontSize: '0.9rem',
                                                                    fontWeight: '700',
                                                                    ...(auditoria.status === 'aprovada' ? {
                                                                        background: '#dcfce7',
                                                                        color: '#16a34a',
                                                                        border: '2px solid #16a34a'
                                                                    } : auditoria.status === 'aguardando_aprovacao' ? {
                                                                        background: '#fef3c7',
                                                                        color: '#d97706',
                                                                        border: '2px solid #f59e0b'
                                                                    } : {
                                                                        background: '#e0e7ff',
                                                                        color: '#5b21b6',
                                                                        border: '2px solid #8b5cf6'
                                                                    })
                                                                }
                                                            }, auditoria.status === 'aprovada' ? '‚úÖ APROVADA' : 
                                                               auditoria.status === 'aguardando_aprovacao' ? '‚è≥ AGUARDANDO' : 
                                                               'üìù EM ANDAMENTO'),
                                                            auditoria.status === 'em_andamento' && h('button', {
                                                                onClick: () => {
                                                                    setCurrentAuditoriaState(auditoria);
                                                                    setAuditoriaFormState(auditoria);
                                                                },
                                                                style: {
                                                                    background: '#8b5cf6',
                                                                    color: 'white',
                                                                    padding: '12px 20px',
                                                                    border: 'none',
                                                                    borderRadius: '8px',
                                                                    cursor: 'pointer',
                                                                    fontWeight: '600'
                                                                }
                                                            }, 'üìù Continuar')
                                                        )
                                                    )
                                                )
                                        )
                                    )
                                )
                            )
                        );
                    };

                    // P√°gina do Painel da Cidade
                    const PainelCidadePage = () => {
                        const checklistsAprovados = checklists.filter(c => c.status === 'aprovado');
                        const auditoriasAprovadas = auditorias.filter(a => a.status === 'aprovada');
                        
                        const pontuacaoChecklist = checklistsAprovados.length * 50; // 50 pontos por checklist
                        const pontuacaoAuditoria = auditoriasAprovadas.length * 100; // 100 pontos por auditoria
                        const pontuacaoTotal = pontuacaoChecklist + pontuacaoAuditoria;
                        
                        const metaCidade = 815; // Meta da cidade

                        return h('div', { style: { minHeight: '100vh', background: '#f8fafc' } },
                            h(Header),
                            h('div', { style: { display: 'flex' } },
                                h(Sidebar),
                                h('main', { style: { flex: 1, padding: '40px' } },
                                    h('h2', { style: { fontSize: '2.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '32px' } }, 'üèôÔ∏è Painel da Cidade'),
                                    
                                    // Card principal da pontua√ß√£o
                                    h('div', { style: { background: 'white', borderRadius: '16px', padding: '40px', boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)', textAlign: 'center', marginBottom: '32px' } },
                                        h('div', { style: { display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: '16px' } },
                                            h('img', { 
                                                src: 'arh6AXLgsTz2G5P60d8DS', 
                                                alt: 'Ilusion RP',
                                                style: { width: '60px', height: '35px', marginRight: '16px' }
                                            }),
                                            h('h3', { style: { fontSize: '2rem', fontWeight: 'bold', color: '#1f2937', margin: 0 } }, 'Pontua√ß√£o Ilusion RP')
                                        ),
                                        
                                        h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '32px', marginBottom: '32px' } },
                                            // Checklist
                                            h('div', { style: { textAlign: 'center' } },
                                                h('div', { style: { fontSize: '4rem', marginBottom: '16px' } }, '‚úÖ'),
                                                h('h4', { style: { fontSize: '1.3rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '8px' } }, 'Checklists'),
                                                h('p', { style: { fontSize: '2.5rem', fontWeight: 'bold', color: '#3b82f6' } }, pontuacaoChecklist),
                                                h('p', { style: { color: '#6b7280' } }, `${checklistsAprovados.length} aprovados √ó 50 pts`)
                                            ),
                                            
                                            // Auditoria
                                            h('div', { style: { textAlign: 'center' } },
                                                h('div', { style: { fontSize: '4rem', marginBottom: '16px' } }, 'üîç'),
                                                h('h4', { style: { fontSize: '1.3rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '8px' } }, 'Auditorias'),
                                                h('p', { style: { fontSize: '2.5rem', fontWeight: 'bold', color: '#10b981' } }, pontuacaoAuditoria),
                                                h('p', { style: { color: '#6b7280' } }, `${auditoriasAprovadas.length} aprovadas √ó 100 pts`)
                                            ),
                                            
                                            // Total
                                            h('div', { style: { textAlign: 'center' } },
                                                h('div', { style: { fontSize: '4rem', marginBottom: '16px' } }, 'üèÜ'),
                                                h('h4', { style: { fontSize: '1.3rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '8px' } }, 'Total'),
                                                h('p', { style: { fontSize: '2.5rem', fontWeight: 'bold', color: '#8b5cf6' } }, pontuacaoTotal),
                                                h('p', { style: { color: '#6b7280' } }, 'Pontos acumulados')
                                            )
                                        ),
                                        
                                        // Progresso para meta
                                        h('div', { style: { background: '#f8fafc', padding: '24px', borderRadius: '12px' } },
                                            h('h4', { style: { fontSize: '1.2rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '16px' } }, 
                                                `üéØ Progresso para Meta: ${metaCidade} pontos`
                                            ),
                                            h('div', { style: { width: '100%', background: '#e5e7eb', borderRadius: '20px', height: '20px', position: 'relative' } },
                                                h('div', {
                                                    style: {
                                                        width: `${Math.min((pontuacaoTotal / metaCidade) * 100, 100)}%`,
                                                        background: pontuacaoTotal >= metaCidade ? 
                                                            'linear-gradient(90deg, #10b981, #16a34a)' : 
                                                            'linear-gradient(90deg, #3b82f6, #8b5cf6)',
                                                        height: '100%',
                                                        borderRadius: '20px',
                                                        transition: 'width 0.5s ease'
                                                    }
                                                }),
                                                h('div', {
                                                    style: {
                                                        position: 'absolute',
                                                        top: '50%',
                                                        left: '50%',
                                                        transform: 'translate(-50%, -50%)',
                                                        fontSize: '0.9rem',
                                                        fontWeight: 'bold',
                                                        color: 'white',
                                                        textShadow: '1px 1px 2px rgba(0,0,0,0.5)'
                                                    }
                                                }, `${Math.round((pontuacaoTotal / metaCidade) * 100)}%`)
                                            ),
                                            h('div', { style: { display: 'flex', justifyContent: 'space-between', marginTop: '8px' } },
                                                h('span', { style: { fontSize: '0.9rem', color: '#6b7280' } }, '0'),
                                                h('span', { style: { fontSize: '0.9rem', color: '#6b7280' } }, metaCidade)
                                            ),
                                            
                                            pontuacaoTotal >= metaCidade ? 
                                                h('p', { style: { textAlign: 'center', marginTop: '16px', fontSize: '1.2rem', fontWeight: 'bold', color: '#16a34a' } }, 
                                                    'üéâ PARAB√âNS! Meta da cidade atingida!'
                                                ) : 
                                                h('p', { style: { textAlign: 'center', marginTop: '16px', fontSize: '1.1rem', color: '#6b7280' } }, 
                                                    `Faltam ${metaCidade - pontuacaoTotal} pontos para atingir a meta`
                                                )
                                        )
                                    )
                                )
                            )
                        );
                    };

                    // P√°gina de Administra√ß√£o COMPLETA RESTAURADA
                    const AdminPage = () => {
                        const approveUser = (userId) => {
                            const user = pendingUsers.find(u => u.id === userId);
                            if (user) {
                                setUsers([...users, { ...user, status: 'aprovado' }]);
                                setPendingUsers(pendingUsers.filter(u => u.id !== userId));
                                alert('‚úÖ Usu√°rio aprovado com sucesso!');
                            }
                        };

                        const rejectUser = (userId) => {
                            setPendingUsers(pendingUsers.filter(u => u.id !== userId));
                            alert('‚ùå Usu√°rio rejeitado!');
                        };

                        const approvePasswordReset = (resetId) => {
                            const resetRequest = pendingPasswordResets.find(r => r.id === resetId);
                            if (resetRequest) {
                                setUsers(users.map(u => 
                                    u.id === resetRequest.userId ? { ...u, senha: resetRequest.novaSenha } : u
                                ));
                                setPendingPasswordResets(pendingPasswordResets.filter(r => r.id !== resetId));
                                alert('‚úÖ Reset de senha aprovado! Senha alterada com sucesso.');
                            }
                        };

                        const rejectPasswordReset = (resetId) => {
                            setPendingPasswordResets(pendingPasswordResets.filter(r => r.id !== resetId));
                            alert('‚ùå Reset de senha rejeitado!');
                        };

                        const approveChecklist = (checklistId) => {
                            setChecklists(checklists.map(c => 
                                c.id === checklistId ? { 
                                    ...c, 
                                    status: 'aprovado', 
                                    approvedBy: currentUser.id, 
                                    approvedAt: new Date().toISOString() 
                                } : c
                            ));
                            alert('‚úÖ Checklist aprovado! +50 pontos para a cidade!');
                        };

                        const rejectChecklist = (checklistId) => {
                            const checklist = checklists.find(c => c.id === checklistId);
                            const motivo = prompt('Motivo da rejei√ß√£o:');
                            if (motivo) {
                                setChecklists(checklists.map(c => 
                                    c.id === checklistId ? { 
                                        ...c, 
                                        status: 'rejeitado',
                                        rejectedBy: currentUser.id,
                                        rejectedAt: new Date().toISOString(),
                                        motivoRejeicao: motivo
                                    } : c
                                ));
                                alert('‚ùå Checklist rejeitado!');
                            }
                        };

                        const approveAuditoria = (auditoriaId) => {
                            setAuditorias(auditorias.map(a => 
                                a.id === auditoriaId ? { 
                                    ...a, 
                                    status: 'aprovada', 
                                    approvedBy: currentUser.id, 
                                    approvedAt: new Date().toISOString() 
                                } : a
                            ));
                            alert('‚úÖ Auditoria aprovada! +100 pontos para a cidade!');
                        };

                        const rejectAuditoria = (auditoriaId) => {
                            const auditoria = auditorias.find(a => a.id === auditoriaId);
                            const motivo = prompt('Motivo da rejei√ß√£o:');
                            if (motivo) {
                                setAuditorias(auditorias.map(a => 
                                    a.id === auditoriaId ? { 
                                        ...a, 
                                        status: 'rejeitada',
                                        rejectedBy: currentUser.id,
                                        rejectedAt: new Date().toISOString(),
                                        motivoRejeicao: motivo
                                    } : a
                                ));
                                alert('‚ùå Auditoria rejeitada!');
                            }
                        };

                        const checklistsPendentes = checklists.filter(c => c.status === 'aguardando_aprovacao');
                        const auditoriasPendentes = auditorias.filter(a => a.status === 'aguardando_aprovacao');

                        return h('div', { style: { minHeight: '100vh', background: '#f8fafc' } },
                            h(Header),
                            h('div', { style: { display: 'flex' } },
                                h(Sidebar),
                                h('main', { style: { flex: 1, padding: '40px', maxWidth: '1600px', margin: '0 auto' } },
                                    h('h2', { style: { fontSize: '2.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '32px' } }, '‚öôÔ∏è Administra√ß√£o'),
                                    
                                    // Estat√≠sticas do painel admin
                                    h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '24px', marginBottom: '40px' } },
                                        h('div', { style: { background: 'linear-gradient(135deg, #f59e0b, #d97706)', color: 'white', padding: '24px', borderRadius: '12px', textAlign: 'center' } },
                                            h('div', { style: { fontSize: '3rem', marginBottom: '8px' } }, 'üë§'),
                                            h('h3', { style: { fontSize: '1.2rem', marginBottom: '4px', opacity: 0.9 } }, 'Usu√°rios Pendentes'),
                                            h('p', { style: { fontSize: '2.5rem', fontWeight: 'bold', margin: 0 } }, pendingUsers.length)
                                        ),
                                        h('div', { style: { background: 'linear-gradient(135deg, #3b82f6, #1d4ed8)', color: 'white', padding: '24px', borderRadius: '12px', textAlign: 'center' } },
                                            h('div', { style: { fontSize: '3rem', marginBottom: '8px' } }, '‚úÖ'),
                                            h('h3', { style: { fontSize: '1.2rem', marginBottom: '4px', opacity: 0.9 } }, 'Checklists Pendentes'),
                                            h('p', { style: { fontSize: '2.5rem', fontWeight: 'bold', margin: 0 } }, checklistsPendentes.length)
                                        ),
                                        h('div', { style: { background: 'linear-gradient(135deg, #8b5cf6, #7c3aed)', color: 'white', padding: '24px', borderRadius: '12px', textAlign: 'center' } },
                                            h('div', { style: { fontSize: '3rem', marginBottom: '8px' } }, 'üîç'),
                                            h('h3', { style: { fontSize: '1.2rem', marginBottom: '4px', opacity: 0.9 } }, 'Auditorias Pendentes'),
                                            h('p', { style: { fontSize: '2.5rem', fontWeight: 'bold', margin: 0 } }, auditoriasPendentes.length)
                                        ),
                                        h('div', { style: { background: 'linear-gradient(135deg, #10b981, #059669)', color: 'white', padding: '24px', borderRadius: '12px', textAlign: 'center' } },
                                            h('div', { style: { fontSize: '3rem', marginBottom: '8px' } }, 'üë•'),
                                            h('h3', { style: { fontSize: '1.2rem', marginBottom: '4px', opacity: 0.9 } }, 'Total de Usu√°rios'),
                                            h('p', { style: { fontSize: '2.5rem', fontWeight: 'bold', margin: 0 } }, users.length)
                                        )
                                    ),
                                    
                                    // Usu√°rios pendentes
                                    h('div', { style: { background: 'white', borderRadius: '16px', padding: '32px', boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)', marginBottom: '32px' } },
                                        h('h3', { style: { fontSize: '1.8rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '24px', display: 'flex', alignItems: 'center', gap: '12px' } }, 
                                            h('span', { style: { fontSize: '2rem' } }, 'üë§'),
                                            `Usu√°rios Pendentes de Aprova√ß√£o (${pendingUsers.length})`
                                        ),
                                        pendingUsers.length === 0 ? 
                                            h('div', { style: { textAlign: 'center', padding: '50px', background: '#fefbff', borderRadius: '16px', border: '2px solid #f59e0b' } },
                                                h('div', { style: { fontSize: '4rem', marginBottom: '16px' } }, 'üë•'),
                                                h('h4', { style: { fontSize: '1.3rem', fontWeight: '700', color: '#f59e0b', marginBottom: '8px' } }, 'Sem pend√™ncias!'),
                                                h('p', { style: { fontSize: '1.1rem', color: '#6b7280', margin: 0 } }, 'Todos os usu√°rios foram processados'),
                                                h('p', { style: { fontSize: '0.9rem', color: '#9ca3af', marginTop: '8px' } }, 'Novos cadastros aparecer√£o aqui para aprova√ß√£o')
                                            ) :
                                        h('div', { style: { display: 'grid', gap: '16px' } },
                                            pendingUsers.map(user => 
                                                h('div', {
                                                    key: user.id,
                                                    style: {
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'center',
                                                        padding: '24px',
                                                        border: '2px solid #f59e0b',
                                                        borderRadius: '16px',
                                                        background: '#fef3c7'
                                                    }
                                                },
                                                    h('div', { style: { flex: 1 } },
                                                        h('p', { style: { fontWeight: '700', color: '#1f2937', fontSize: '1.2rem', margin: '0 0 8px 0' } }, user.nome),
                                                        h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px' } },
                                                            h('p', { style: { color: '#6b7280', fontSize: '0.9rem', margin: 0 } }, `üÜî ID: ${user.id}`),
                                                            h('p', { style: { color: '#6b7280', fontSize: '0.9rem', margin: 0 } }, `üëî Cargo: ${user.cargo}`),
                                                            h('p', { style: { color: '#6b7280', fontSize: '0.9rem', margin: 0 } }, `üìÖ Criado: ${new Date(user.createdAt).toLocaleDateString('pt-BR')}`)
                                                        )
                                                    ),
                                                    h('div', { style: { display: 'flex', gap: '12px' } },
                                                        h('button', {
                                                            onClick: () => approveUser(user.id),
                                                            style: {
                                                                background: '#16a34a',
                                                                color: 'white',
                                                                padding: '12px 20px',
                                                                border: 'none',
                                                                borderRadius: '8px',
                                                                cursor: 'pointer',
                                                                fontWeight: '600',
                                                                display: 'flex',
                                                                alignItems: 'center',
                                                                gap: '8px'
                                                            }
                                                        }, '‚úÖ Aprovar'),
                                                        h('button', {
                                                            onClick: () => rejectUser(user.id),
                                                            style: {
                                                                background: '#dc2626',
                                                                color: 'white',
                                                                padding: '12px 20px',
                                                                border: 'none',
                                                                borderRadius: '8px',
                                                                cursor: 'pointer',
                                                                fontWeight: '600',
                                                                display: 'flex',
                                                                alignItems: 'center',
                                                                gap: '8px'
                                                            }
                                                        }, '‚ùå Rejeitar')
                                                    )
                                                )
                                            )
                                        )
                                    ),

                                    // Valida√ß√µes pendentes em grid
                                    h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(500px, 1fr))', gap: '32px' } },
                                        // Checklists pendentes
                                        h('div', { style: { background: 'white', borderRadius: '16px', padding: '28px', boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)' } },
                                            h('h3', { style: { fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '20px', display: 'flex', alignItems: 'center', gap: '12px' } }, 
                                                h('span', { style: { fontSize: '2rem' } }, '‚úÖ'),
                                                `Checklists para Aprova√ß√£o (${checklistsPendentes.length})`
                                            ),
                                            checklistsPendentes.length === 0 ? 
                                                h('div', { style: { textAlign: 'center', padding: '50px', background: '#f0fdf4', borderRadius: '16px', border: '2px solid #10b981' } },
                                                    h('div', { style: { fontSize: '4rem', marginBottom: '16px' } }, 'üéâ'),
                                                    h('h4', { style: { fontSize: '1.3rem', fontWeight: '700', color: '#10b981', marginBottom: '8px' } }, 'Tudo em dia!'),
                                                    h('p', { style: { fontSize: '1.1rem', color: '#6b7280', margin: 0 } }, 'Nenhum checklist aguardando aprova√ß√£o'),
                                                    h('p', { style: { fontSize: '0.9rem', color: '#9ca3af', marginTop: '8px' } }, 'Quando houver checklists para revisar, eles aparecer√£o aqui')
                                                ) :
                                                h('div', { style: { display: 'grid', gap: '16px' } },
                                                    checklistsPendentes.slice(0, 8).map(checklist => 
                                                        h('div', {
                                                            key: checklist.id,
                                                            style: {
                                                                padding: '20px',
                                                                border: '2px solid #fbbf24',
                                                                borderRadius: '12px',
                                                                background: '#fef3c7'
                                                            }
                                                        },
                                                            h('div', { style: { marginBottom: '12px' } },
                                                                h('p', { style: { fontWeight: '700', fontSize: '1rem', marginBottom: '8px', color: '#1f2937' } }, 
                                                                    `${checklist.tipo === 'staff' ? 'STAFF' : 'ROLEPLAY'} - ${checklist.equipe || checklist.setor}`
                                                                ),
                                                                h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))', gap: '8px' } },
                                                                    h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, 
                                                                        `üë§ ${users.find(u => u.id === checklist.autorId)?.nome || 'Usu√°rio'}`
                                                                    ),
                                                                    h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, 
                                                                        `üìÖ ${new Date(checklist.createdAt).toLocaleDateString('pt-BR')}`
                                                                    ),
                                                                    checklist.subsetor && h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, 
                                                                        `üöî ${checklist.subsetor}`
                                                                    )
                                                                )
                                                            ),
                                                            // Mostrar confirma√ß√µes de painel
                                                            checklist.confirmacoesPainel && h('div', { style: { marginBottom: '12px', padding: '10px', background: 'rgba(255, 255, 255, 0.5)', borderRadius: '8px' } },
                                                                h('p', { style: { fontSize: '0.8rem', fontWeight: '600', color: '#1f2937', marginBottom: '4px' } }, 'üìä Confirma√ß√µes de Painel:'),
                                                                h('div', { style: { display: 'flex', gap: '12px', fontSize: '0.75rem' } },
                                                                    h('span', null, `üåÖ Manh√£: ${checklist.confirmacoesPainel.manha || 'N/A'}`),
                                                                    h('span', null, `‚òÄÔ∏è Tarde: ${checklist.confirmacoesPainel.tarde || 'N/A'}`),
                                                                    h('span', null, `üåô Noite: ${checklist.confirmacoesPainel.noite || 'N/A'}`)
                                                                )
                                                            ),
                                                            h('div', { style: { display: 'flex', gap: '8px' } },
                                                                h('button', {
                                                                    onClick: () => approveChecklist(checklist.id),
                                                                    style: {
                                                                        background: '#16a34a',
                                                                        color: 'white',
                                                                        padding: '10px 16px',
                                                                        border: 'none',
                                                                        borderRadius: '6px',
                                                                        cursor: 'pointer',
                                                                        fontSize: '0.85rem',
                                                                        fontWeight: '600'
                                                                    }
                                                                }, '‚úÖ Aprovar'),
                                                                h('button', {
                                                                    onClick: () => rejectChecklist(checklist.id),
                                                                    style: {
                                                                        background: '#dc2626',
                                                                        color: 'white',
                                                                        padding: '10px 16px',
                                                                        border: 'none',
                                                                        borderRadius: '6px',
                                                                        cursor: 'pointer',
                                                                        fontSize: '0.85rem',
                                                                        fontWeight: '600'
                                                                    }
                                                                }, '‚ùå Rejeitar')
                                                            )
                                                        )
                                                    ),
                                                    checklistsPendentes.length > 8 && h('div', { style: { textAlign: 'center', padding: '16px' } },
                                                        h('p', { style: { color: '#6b7280', fontSize: '0.9rem' } }, 
                                                            `... e mais ${checklistsPendentes.length - 8} checklists`
                                                        )
                                                    )
                                                )
                                        ),

                                        // Auditorias pendentes
                                        h('div', { style: { background: 'white', borderRadius: '16px', padding: '28px', boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)' } },
                                            h('h3', { style: { fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '20px', display: 'flex', alignItems: 'center', gap: '12px' } }, 
                                                h('span', { style: { fontSize: '2rem' } }, 'üîç'),
                                                `Auditorias para Aprova√ß√£o (${auditoriasPendentes.length})`
                                            ),
                                            auditoriasPendentes.length === 0 ? 
                                                h('div', { style: { textAlign: 'center', padding: '50px', background: '#fef3ff', borderRadius: '16px', border: '2px solid #8b5cf6' } },
                                                    h('div', { style: { fontSize: '4rem', marginBottom: '16px' } }, 'üéØ'),
                                                    h('h4', { style: { fontSize: '1.3rem', fontWeight: '700', color: '#8b5cf6', marginBottom: '8px' } }, '√Årea limpa!'),
                                                    h('p', { style: { fontSize: '1.1rem', color: '#6b7280', margin: 0 } }, 'Nenhuma auditoria aguardando aprova√ß√£o'),
                                                    h('p', { style: { fontSize: '0.9rem', color: '#9ca3af', marginTop: '8px' } }, 'Auditorias completas aparecer√£o aqui para sua valida√ß√£o')
                                                ) :
                                                h('div', { style: { display: 'grid', gap: '16px' } },
                                                    auditoriasPendentes.slice(0, 8).map(auditoria => 
                                                        h('div', {
                                                            key: auditoria.id,
                                                            style: {
                                                                padding: '20px',
                                                                border: '2px solid #a855f7',
                                                                borderRadius: '12px',
                                                                background: '#faf5ff'
                                                            }
                                                        },
                                                            h('div', { style: { marginBottom: '12px' } },
                                                                h('p', { style: { fontWeight: '700', fontSize: '1rem', marginBottom: '8px', color: '#1f2937' } }, 
                                                                    `${auditoria.tipo.toUpperCase()} - ${auditoria.setor}`
                                                                ),
                                                                h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))', gap: '8px' } },
                                                                    h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, 
                                                                        `üë§ ${users.find(u => u.id === auditoria.autorId)?.nome || 'Usu√°rio'}`
                                                                    ),
                                                                    h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, 
                                                                        `üìÖ ${new Date(auditoria.createdAt).toLocaleDateString('pt-BR')}`
                                                                    ),
                                                                    auditoria.turno && h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, 
                                                                        `üïê ${auditoria.turno}`
                                                                    ),
                                                                    auditoria.subsetor && h('p', { style: { fontSize: '0.85rem', color: '#6b7280', margin: 0 } }, 
                                                                        `üöî ${auditoria.subsetor}`
                                                                    ),
                                                                    auditoria.duracaoAutomatica && h('p', { style: { fontSize: '0.85rem', color: '#059669', margin: 0, fontWeight: '600' } }, 
                                                                        `‚è±Ô∏è ${auditoria.duracaoAutomatica}`
                                                                    )
                                                                )
                                                            ),
                                                            auditoria.relatorioFinal && h('div', { style: { marginBottom: '12px', padding: '10px', background: 'rgba(255, 255, 255, 0.5)', borderRadius: '8px' } },
                                                                h('p', { style: { fontSize: '0.8rem', fontWeight: '600', color: '#1f2937', marginBottom: '4px' } }, 'üìù Relat√≥rio:'),
                                                                h('p', { style: { fontSize: '0.75rem', color: '#6b7280', margin: 0, lineHeight: '1.4' } }, 
                                                                    auditoria.relatorioFinal.length > 100 ? 
                                                                        auditoria.relatorioFinal.substring(0, 100) + '...' : 
                                                                        auditoria.relatorioFinal
                                                                )
                                                            ),
                                                            h('div', { style: { display: 'flex', gap: '8px' } },
                                                                h('button', {
                                                                    onClick: () => approveAuditoria(auditoria.id),
                                                                    style: {
                                                                        background: '#16a34a',
                                                                        color: 'white',
                                                                        padding: '10px 16px',
                                                                        border: 'none',
                                                                        borderRadius: '6px',
                                                                        cursor: 'pointer',
                                                                        fontSize: '0.85rem',
                                                                        fontWeight: '600'
                                                                    }
                                                                }, '‚úÖ Aprovar'),
                                                                h('button', {
                                                                    onClick: () => rejectAuditoria(auditoria.id),
                                                                    style: {
                                                                        background: '#dc2626',
                                                                        color: 'white',
                                                                        padding: '10px 16px',
                                                                        border: 'none',
                                                                        borderRadius: '6px',
                                                                        cursor: 'pointer',
                                                                        fontSize: '0.85rem',
                                                                        fontWeight: '600'
                                                                    }
                                                                }, '‚ùå Rejeitar')
                                                            )
                                                        )
                                                    ),
                                                    auditoriasPendentes.length > 8 && h('div', { style: { textAlign: 'center', padding: '16px' } },
                                                        h('p', { style: { color: '#6b7280', fontSize: '0.9rem' } }, 
                                                            `... e mais ${auditoriasPendentes.length - 8} auditorias`
                                                        )
                                                    )
                                                )
                                        )
                                    )
                                )
                            )
                        );
                    };

                    // Se n√£o logado, mostrar login
                    if (!currentUser) {
                        return h(LoginPage);
                    }

                    // Roteamento das p√°ginas
                    switch (currentView) {
                        case 'checklist':
                            return h(ChecklistPage);
                        case 'auditoria':
                            return h(AuditoriaPage);
                        case 'painel':
                            return h(PainelCidadePage);
                        case 'admin':
                            if (currentUser?.cargo === 'CEO' || currentUser?.cargo === 'Diretor') {
                                return h(AdminPage);
                            }
                            return h(DashboardPage);
                        default:
                            return h(DashboardPage);
                    }
                };

                // Renderizar aplica√ß√£o
                const rootElement = document.getElementById('root');
                if (rootElement) {
                    const root = ReactDOM.createRoot(rootElement);
                    root.render(h(MetaXSystem));
                    console.log('‚úÖ MetaX System v4.0 ULTRA COMPLETO carregado com sucesso!');
                    console.log('üöî Subsetor da Pol√≠cia implementado na Auditoria!');
                    console.log('‚è∞ Dura√ß√£o autom√°tica das auditorias implementada!');
                    console.log('üéØ Sistema 100% funcional restaurado!');
                } else {
                    throw new Error('Elemento root n√£o encontrado');
                }

            } catch (error) {
                console.error('‚ùå Erro ao carregar MetaX:', error);
                document.getElementById('root').innerHTML = `
                    <div style="
                        min-height: 100vh;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        background: linear-gradient(135deg, #ef4444, #dc2626);
                        color: white;
                        font-family: system-ui;
                        text-align: center;
                        padding: 2rem;
                    ">
                        <div style="
                            background: rgba(255,255,255,0.1);
                            backdrop-filter: blur(10px);
                            border-radius: 1rem;
                            padding: 2rem;
                            border: 1px solid rgba(255,255,255,0.2);
                        ">
                            <h1 style="font-size: 3rem; margin-bottom: 1rem;">‚ö†Ô∏è</h1>
                            <h2 style="font-size: 1.5rem; margin-bottom: 1rem;">Erro no Sistema MetaX</h2>
                            <p style="margin-bottom: 1.5rem; opacity: 0.9;">${error.message}</p>
                            <button onclick="location.reload()" style="
                                background: white;
                                color: #dc2626;
                                border: none;
                                padding: 0.75rem 1.5rem;
                                border-radius: 0.5rem;
                                font-weight: bold;
                                cursor: pointer;
                                font-size: 1rem;
                            ">
                                üîÑ Recarregar P√°gina
                            </button>
                        </div>
                    </div>
                `;
            }
        }, 1000);
    </script>
</body>
</html>
